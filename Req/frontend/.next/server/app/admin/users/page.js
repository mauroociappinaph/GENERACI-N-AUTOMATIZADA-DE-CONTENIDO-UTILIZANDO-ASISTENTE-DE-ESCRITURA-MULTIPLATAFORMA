(()=>{var e={};e.id=674,e.ids=[674],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},4544:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),r(67484),r(18373),r(52593);var a=r(93826),s=r(49930),i=r(42049),l=r.n(i),n=r(88405),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let c=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,67484)),"/Users/mauroociappina/Desktop/Dazlab/Proyecto 40/Repo/gravitad-040-2024-gravitad-generacio-actualizada-contenido-asist-de-escritura-plataforma/Req/frontend/src/app/admin/users/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,18373)),"/Users/mauroociappina/Desktop/Dazlab/Proyecto 40/Repo/gravitad-040-2024-gravitad-generacio-actualizada-contenido-asist-de-escritura-plataforma/Req/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,52593,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/mauroociappina/Desktop/Dazlab/Proyecto 40/Repo/gravitad-040-2024-gravitad-generacio-actualizada-contenido-asist-de-escritura-plataforma/Req/frontend/src/app/admin/users/page.tsx"],u="/admin/users/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},49536:(e,t,r)=>{Promise.resolve().then(r.bind(r,85428))},85428:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>E});var a=r(31694),s=r(32916),i=r(27667),l=r(66352),n=r(16546),o=r(52166);function c({users:e,loading:t,pagination:r,onEdit:a,onToggleStatus:s,onDelete:i,onPageChange:c}){let d=e=>new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}),u=e=>({[l.i4.ADMIN]:"bg-red-100 text-red-800",[l.i4.MANAGER]:"bg-blue-100 text-blue-800",[l.i4.USER]:"bg-green-100 text-green-800",[l.i4.VIEWER]:"bg-gray-100 text-gray-800"})[e]||"bg-gray-100 text-gray-800";return t&&!e.length?o.jsx("div",{className:"flex justify-center items-center py-8",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,o.jsxs)("div",{className:"space-y-4",children:[o.jsx("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Creado"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,o.jsxs)("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.firstName," ",e.lastName]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:e.email})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${u(e.role)}`,children:e.role})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.isActive?"Activo":"Inactivo"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d(e.createdAt)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,o.jsxs)("div",{className:"flex justify-end gap-2",children:[o.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>a(e),children:"Editar"}),o.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>s(e.id),className:e.isActive?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800",children:e.isActive?"Desactivar":"Activar"}),o.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>i(e.id),className:"text-red-600 hover:text-red-800",children:"Eliminar"})]})})]},e.id))})]})}),0===e.length&&!t&&o.jsx("div",{className:"text-center py-8 text-gray-500",children:"No se encontraron usuarios"}),r.totalPages>1&&(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"text-sm text-gray-700",children:["Mostrando ",(r.page-1)*r.limit+1," a"," ",Math.min(r.page*r.limit,r.total)," de"," ",r.total," usuarios"]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[o.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>c(r.page-1),disabled:r.page<=1,children:"Anterior"}),Array.from({length:r.totalPages},(e,t)=>t+1).filter(e=>{let t=r.page;return 1===e||e===r.totalPages||e>=t-1&&e<=t+1}).map((e,t,a)=>(0,o.jsxs)("div",{className:"flex items-center",children:[t>0&&a[t-1]!==e-1&&o.jsx("span",{className:"px-2 text-gray-500",children:"..."}),o.jsx(n.z,{variant:r.page===e?"default":"outline",size:"sm",onClick:()=>c(e),children:e})]},e)),o.jsx(n.z,{variant:"outline",size:"sm",onClick:()=>c(r.page+1),disabled:r.page>=r.totalPages,children:"Siguiente"})]})]})]})}var d=r(3113);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){var a,s;a=t,s=r[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(a))in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p({roles:e,onSubmit:t,onClose:r}){let{0:s,1:i}=(0,a.useState)({email:"",password:"",firstName:"",lastName:"",role:l.i4.USER}),{0:c,1:u}=(0,a.useState)(!1),{0:p,1:x}=(0,a.useState)({}),h=()=>{let e={};return s.email?/\S+@\S+\.\S+/.test(s.email)||(e.email="El email no es v\xe1lido"):e.email="El email es requerido",s.password?s.password.length<8&&(e.password="La contrase\xf1a debe tener al menos 8 caracteres"):e.password="La contrase\xf1a es requerida",s.firstName||(e.firstName="El nombre es requerido"),s.lastName||(e.lastName="El apellido es requerido"),x(e),0===Object.keys(e).length},g=async e=>{if(e.preventDefault(),h())try{u(!0),await t(s)}catch(e){console.error("Error creating user:",e)}finally{u(!1)}},f=(e,t)=>{i(r=>m(m({},r),{},{[e]:t})),p[e]&&x(t=>m(m({},t),{},{[e]:""}))};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Crear Nuevo Usuario"}),(0,o.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),o.jsx(d.I,{id:"firstName",type:"text",value:s.firstName,onChange:e=>f("firstName",e.target.value),className:p.firstName?"border-red-500":""}),p.firstName&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.firstName})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido"}),o.jsx(d.I,{id:"lastName",type:"text",value:s.lastName,onChange:e=>f("lastName",e.target.value),className:p.lastName?"border-red-500":""}),p.lastName&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.lastName})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsx(d.I,{id:"email",type:"email",value:s.email,onChange:e=>f("email",e.target.value),className:p.email?"border-red-500":""}),p.email&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.email})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrase\xf1a"}),o.jsx(d.I,{id:"password",type:"password",value:s.password,onChange:e=>f("password",e.target.value),className:p.password?"border-red-500":""}),p.password&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.password})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),o.jsx("select",{id:"role",value:s.role,onChange:e=>f("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:e.map(e=>o.jsx("option",{value:e,children:e},e))})]}),(0,o.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[o.jsx(n.z,{type:"button",variant:"outline",onClick:r,disabled:c,children:"Cancelar"}),o.jsx(n.z,{type:"submit",disabled:c,children:c?"Creando...":"Crear Usuario"})]})]})]})})}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach(function(t){var a,s;a=t,s=r[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(a))in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g({user:e,roles:t,onSubmit:r,onClose:s}){let{0:i,1:l}=(0,a.useState)({email:e.email,firstName:e.firstName,lastName:e.lastName,role:e.role,isActive:e.isActive}),{0:c,1:u}=(0,a.useState)(!1),{0:m,1:p}=(0,a.useState)({}),x=()=>{let e={};return i.email?/\S+@\S+\.\S+/.test(i.email)||(e.email="El email no es v\xe1lido"):e.email="El email es requerido",i.firstName||(e.firstName="El nombre es requerido"),i.lastName||(e.lastName="El apellido es requerido"),p(e),0===Object.keys(e).length},g=async e=>{if(e.preventDefault(),x())try{u(!0),await r(i)}catch(e){console.error("Error updating user:",e)}finally{u(!1)}},f=(e,t)=>{l(r=>h(h({},r),{},{[e]:t})),m[e]&&p(t=>h(h({},t),{},{[e]:""}))};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Editar Usuario"}),(0,o.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),o.jsx(d.I,{id:"firstName",type:"text",value:i.firstName,onChange:e=>f("firstName",e.target.value),className:m.firstName?"border-red-500":""}),m.firstName&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.firstName})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido"}),o.jsx(d.I,{id:"lastName",type:"text",value:i.lastName,onChange:e=>f("lastName",e.target.value),className:m.lastName?"border-red-500":""}),m.lastName&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.lastName})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsx(d.I,{id:"email",type:"email",value:i.email,onChange:e=>f("email",e.target.value),className:m.email?"border-red-500":""}),m.email&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.email})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),o.jsx("select",{id:"role",value:i.role,onChange:e=>f("role",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:t.map(e=>o.jsx("option",{value:e,children:e},e))})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[o.jsx("input",{id:"isActive",type:"checkbox",checked:i.isActive,onChange:e=>f("isActive",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Usuario activo"})]}),(0,o.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[o.jsx(n.z,{type:"button",variant:"outline",onClick:s,disabled:c,children:"Cancelar"}),o.jsx(n.z,{type:"submit",disabled:c,children:c?"Guardando...":"Guardar Cambios"})]})]})]})})}function f({searchTerm:e,roleFilter:t,statusFilter:r,roles:a,onSearchChange:s,onRoleFilterChange:i,onStatusFilterChange:l,onSearch:c,onCreateUser:u}){return(0,o.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-end",children:[o.jsx("form",{onSubmit:c,className:"flex-1",children:o.jsx(d.I,{type:"text",placeholder:"Buscar usuarios por nombre o email...",value:e,onChange:e=>s(e.target.value)})}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsxs)("select",{value:t,onChange:e=>i(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"ALL",children:"Todos los roles"}),a.map(e=>o.jsx("option",{value:e,children:e},e))]}),(0,o.jsxs)("select",{value:r,onChange:e=>l(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"ALL",children:"Todos los estados"}),o.jsx("option",{value:"ACTIVE",children:"Activos"}),o.jsx("option",{value:"INACTIVE",children:"Inactivos"})]}),o.jsx(n.z,{onClick:u,children:"Crear Usuario"})]})]})}var b=r(64854);function v({open:e,onOpenChange:t,onConfirm:r}){return o.jsx(b.aR,{open:e,onOpenChange:t,children:(0,o.jsxs)(b._T,{children:[(0,o.jsxs)(b.fY,{children:[o.jsx(b.f$,{children:"Confirmar eliminaci\xf3n"}),o.jsx(b.yT,{children:"\xbfEst\xe1 seguro de que desea eliminar este usuario? Esta acci\xf3n no se puede deshacer."})]}),(0,o.jsxs)(b.xo,{children:[o.jsx(b.le,{onClick:()=>t(!1),children:"Cancelar"}),o.jsx(b.OL,{onClick:r,variant:"destructive",children:"Eliminar"})]})]})})}var y=r(34567);function j(){let{0:e,1:t}=(0,a.useState)([]),{0:r,1:s}=(0,a.useState)(!1),{0:i,1:l}=(0,a.useState)(null),{0:n,1:o}=(0,a.useState)({page:1,limit:10,total:0,totalPages:0}),{0:c,1:d}=(0,a.useState)([]),u=(0,a.useCallback)(e=>{let t=new URLSearchParams;return e.page&&t.append("page",e.page.toString()),e.limit&&t.append("limit",e.limit.toString()),e.role&&t.append("role",e.role),void 0!==e.isActive&&t.append("isActive",e.isActive.toString()),e.search&&t.append("search",e.search),t.toString()},[]),m=(0,a.useCallback)(e=>{t(e.data.users),o({page:e.data.page,limit:e.data.limit||10,total:e.data.total,totalPages:e.data.totalPages})},[]),p=(0,a.useCallback)(e=>{l(e.response?.data?.error?.message||"Error al obtener usuarios")},[]),x=(0,a.useCallback)(async(e={})=>{try{s(!0),l(null);let t=u(e),r=await y.hi.get(`/users?${t}`);if(r?.data?.success)m(r.data);else throw Error("Error al obtener usuarios")}catch(e){p(e)}finally{s(!1)}},[u,m,p]),h=(0,a.useCallback)(async()=>{try{let e=await y.hi.get("/users/roles");e?.data?.success&&d(e.data.data.roles)}catch(e){}},[]),g=(0,a.useCallback)(async e=>{try{l(null);let t=await y.hi.post("/users",e);if(!t?.data?.success)throw Error("Error al crear usuario");return t.data.data.user}catch(t){let e=t.response?.data?.error?.message||"Error al crear usuario";throw l(e),Error(e)}},[]),f=(0,a.useCallback)(async(e,t)=>{try{l(null);let r=await y.hi.put(`/users/${e}`,t);if(!r?.data?.success)throw Error("Error al actualizar usuario");return r.data.data.user}catch(t){let e=t.response?.data?.error?.message||"Error al actualizar usuario";throw l(e),Error(e)}},[]);return{users:e,loading:r,error:i,pagination:n,roles:c,fetchUsers:x,fetchRoles:h,createUser:g,updateUser:f,toggleUserStatus:(0,a.useCallback)(async e=>{try{l(null);let t=await y.hi.patch(`/users/${e}/toggle-status`);if(!t?.data?.success)throw Error("Error al cambiar estado del usuario");return t.data.data.user}catch(t){let e=t.response?.data?.error?.message||"Error al cambiar estado del usuario";throw l(e),Error(e)}},[]),deleteUser:(0,a.useCallback)(async e=>{try{l(null);let t=await y.hi.delete(`/users/${e}`);if(!t?.data?.success)throw Error("Error al eliminar usuario");return!0}catch(t){let e=t.response?.data?.error?.message||"Error al eliminar usuario";throw l(e),Error(e)}},[]),changePassword:(0,a.useCallback)(async(e,t,r)=>{try{l(null);let a=await y.hi.put(`/users/${e}/password`,{currentPassword:t,newPassword:r});if(!a?.data?.success)throw Error("Error al cambiar contrase\xf1a");return!0}catch(t){let e=t.response?.data?.error?.message||"Error al cambiar contrase\xf1a";throw l(e),Error(e)}},[])}}var N=r(54566),w=r(41707);function E(){let{0:e,1:t}=(0,a.useState)(!1),{0:r,1:n}=(0,a.useState)(null),{users:d,loading:u,error:m,pagination:x,roles:h,fetchRoles:b}=j(),{searchTerm:y,setSearchTerm:E,roleFilter:C,setRoleFilter:P,statusFilter:S,setStatusFilter:A,buildCurrentPageFetchParams:O,handleSearch:k,handlePageChange:q}=function(){let{0:e,1:t}=(0,a.useState)(""),{0:r,1:s}=(0,a.useState)("ALL"),{0:i,1:l}=(0,a.useState)("ALL"),{fetchUsers:n,pagination:o}=j(),c=(0,a.useCallback)(()=>({page:1,limit:10,role:"ALL"===r?void 0:r,isActive:"ALL"===i?void 0:"ACTIVE"===i,search:e||void 0}),[r,i,e]),d=(0,a.useCallback)(()=>({page:o.page,limit:o.limit,role:"ALL"===r?void 0:r,isActive:"ALL"===i?void 0:"ACTIVE"===i,search:e||void 0}),[r,i,e,o]);return{searchTerm:e,setSearchTerm:t,roleFilter:r,setRoleFilter:s,statusFilter:i,setStatusFilter:l,buildFetchParams:c,buildCurrentPageFetchParams:d,handleSearch:e=>{e.preventDefault(),n(c())},handlePageChange:t=>{n({page:t,limit:o.limit,role:"ALL"===r?void 0:r,isActive:"ALL"===i?void 0:"ACTIVE"===i,search:e||void 0})}}}(),{deleteConfirmOpen:z,setDeleteConfirmOpen:U,handleCreateUser:D,handleEditUser:L,handleToggleStatus:R,handleDeleteUser:T,confirmDeleteUser:I}=function(){let{0:e,1:t}=(0,a.useState)(!1),{0:r,1:s}=(0,a.useState)(null),{createUser:i,updateUser:l,toggleUserStatus:n,deleteUser:o,fetchUsers:c}=j(),d=async e=>{if(r)try{await o(r),(0,N.A)({title:"Usuario eliminado",description:"El usuario ha sido eliminado exitosamente"}),await c(e)}catch(e){(0,N.A)({title:"Error al eliminar usuario",description:e instanceof Error?e.message:"Error desconocido",variant:"destructive"})}finally{t(!1),s(null)}};return{deleteConfirmOpen:e,setDeleteConfirmOpen:t,userToDelete:r,handleCreateUser:async(e,t,r)=>{try{await i(e),(0,N.A)({title:"Usuario creado",description:"El usuario ha sido creado exitosamente"}),await c(t),r?.()}catch(e){(0,N.A)({title:"Error al crear usuario",description:e instanceof Error?e.message:"Error desconocido",variant:"destructive"})}},handleEditUser:async(e,t,r,a)=>{try{await l(e,t),(0,N.A)({title:"Usuario actualizado",description:"El usuario ha sido actualizado exitosamente"}),await c(r),a?.()}catch(e){(0,N.A)({title:"Error al actualizar usuario",description:e instanceof Error?e.message:"Error desconocido",variant:"destructive"})}},handleToggleStatus:async(e,t)=>{try{await n(e),(0,N.A)({title:"Estado actualizado",description:"El estado del usuario ha sido actualizado exitosamente"}),await c(t)}catch(e){(0,N.A)({title:"Error al cambiar estado del usuario",description:e instanceof Error?e.message:"Error desconocido",variant:"destructive"})}},handleDeleteUser:e=>{s(e),t(!0)},confirmDeleteUser:d}}(),_=async e=>{await D(e,O(),()=>{t(!1)})},F=async e=>{r&&await L(r.id,e,O(),()=>{n(null)})},G=async e=>{await R(e,O())},$=async()=>{await I(O())};return u&&!d.length?o.jsx(s.Z,{title:"Gesti\xf3n de Usuarios",allowedRoles:[l.i4.ADMIN,l.i4.MANAGER],children:o.jsx(w.g,{})}):o.jsx(s.Z,{title:"Gesti\xf3n de Usuarios",allowedRoles:[l.i4.ADMIN,l.i4.MANAGER],children:(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)(i.Zb,{children:[o.jsx(i.Ol,{children:o.jsx(i.ll,{children:"Administraci\xf3n de Usuarios"})}),o.jsx(i.aY,{children:(0,o.jsxs)("div",{className:"space-y-4",children:[o.jsx(f,{searchTerm:y,roleFilter:C,statusFilter:S,roles:h,onSearchChange:E,onRoleFilterChange:P,onStatusFilterChange:A,onSearch:k,onCreateUser:()=>t(!0)}),m&&o.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:m}),o.jsx(c,{users:d,loading:u,pagination:x,onEdit:n,onToggleStatus:G,onDelete:T,onPageChange:q})]})})]}),e&&o.jsx(p,{roles:h,onSubmit:_,onClose:()=>t(!1)}),r&&o.jsx(g,{user:r,roles:h,onSubmit:F,onClose:()=>n(null)}),o.jsx(v,{open:z,onOpenChange:U,onConfirm:$})]})})}},64854:(e,t,r)=>{"use strict";r.d(t,{OL:()=>u,_T:()=>l,aR:()=>i,f$:()=>o,fY:()=>n,le:()=>m,xo:()=>d,yT:()=>c});var a=r(16546),s=r(52166);function i({open:e,onOpenChange:t,children:r}){return e?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>t(!1)}),s.jsx("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:r})]}):null}function l({children:e}){return s.jsx("div",{className:"p-6",children:e})}function n({children:e}){return s.jsx("div",{className:"mb-4",children:e})}function o({children:e}){return s.jsx("h2",{className:"text-lg font-semibold",children:e})}function c({children:e}){return s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:e})}function d({children:e}){return s.jsx("div",{className:"flex justify-end space-x-2 mt-6",children:e})}function u({onClick:e,children:t,variant:r="default"}){return s.jsx(a.z,{onClick:e,variant:"destructive"===r?"danger":"primary",children:t})}function m({onClick:e,children:t}){return s.jsx(a.z,{onClick:e,variant:"outline",children:t})}},54566:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,p:()=>s});var a=r(38597);let s=()=>({toast:e=>{"destructive"===e.variant?a.ZP.error(e.description||e.title||"Error"):a.ZP.success(e.description||e.title||"Success")}}),i=e=>{"destructive"===e.variant?a.ZP.error(e.description||e.title||"Error"):a.ZP.success(e.description||e.title||"Success")}},34567:(e,t,r)=>{"use strict";function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){i(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function i(e,t,r){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:String(a))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{hi:()=>o,x1:()=>n});class l{constructor(e="http://localhost:3001"){i(this,"baseURL",void 0),this.baseURL=e}async request(e,t={}){let r=`${this.baseURL}${e}`,a=s({headers:s({"Content-Type":"application/json"},t.headers)},t),i=localStorage.getItem("accessToken");i&&(a.headers=s(s({},a.headers),{},{Authorization:`Bearer ${i}`}));try{let e=await fetch(r,a),t=await e.json();if(!e.ok)throw Error(t.error?.message||"API request failed");return t}catch(e){throw console.error("API request error:",e),e}}async get(e){return this.request(e,{method:"GET"})}async post(e,t){return this.request(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async put(e,t){return this.request(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}async patch(e,t){return this.request(e,{method:"PATCH",body:t?JSON.stringify(t):void 0})}async delete(e){return this.request(e,{method:"DELETE"})}}let n=new l,o=n},67484:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(87866).createProxy)(String.raw`/Users/mauroociappina/Desktop/Dazlab/Proyecto 40/Repo/gravitad-040-2024-gravitad-generacio-actualizada-contenido-asist-de-escritura-plataforma/Req/frontend/src/app/admin/users/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[588,361,909,805,715,741,630],()=>r(4544));module.exports=a})();