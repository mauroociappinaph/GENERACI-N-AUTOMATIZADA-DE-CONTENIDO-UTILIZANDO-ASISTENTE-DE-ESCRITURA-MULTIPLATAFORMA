(()=>{var e={};e.id=151,e.ids=[151],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8309:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>l,routeModule:()=>x,tree:()=>d}),r(22373),r(18373),r(52593);var t=r(93826),s=r(49930),i=r(42049),n=r.n(i),o=r(88405),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);r.d(a,c);let d=["",{children:["data",{children:["[id]",{children:["edit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,22373)),"/Users/mauroociappina/Desktop/Dazlab/Proyecto 40/Repo/gravitad-040-2024-gravitad-generacio-actualizada-contenido-asist-de-escritura-plataforma/Req/frontend/src/app/data/[id]/edit/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,18373)),"/Users/mauroociappina/Desktop/Dazlab/Proyecto 40/Repo/gravitad-040-2024-gravitad-generacio-actualizada-contenido-asist-de-escritura-plataforma/Req/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,52593,23)),"next/dist/client/components/not-found-error"]}],l=["/Users/mauroociappina/Desktop/Dazlab/Proyecto 40/Repo/gravitad-040-2024-gravitad-generacio-actualizada-contenido-asist-de-escritura-plataforma/Req/frontend/src/app/data/[id]/edit/page.tsx"],u="/data/[id]/edit/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/data/[id]/edit/page",pathname:"/data/[id]/edit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},93307:(e,a,r)=>{Promise.resolve().then(r.bind(r,2610))},2610:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>h});var t=r(42037),s=r(41090),i=r(94456),n=r(44374),o=r(77647),c=r(19534),d=r(27667),l=r(52166);function u({record:e,conflictingRecord:a,history:r,showConflictResolution:u,showVersionHistory:p,isLoading:x,isLoadingRecord:m,isLoadingHistory:h,error:g,onSave:f,onCancel:y,onConflictResolve:v,onConflictCancel:j,onRestoreVersion:b,onShowHistory:R,onCloseHistory:E}){return m?l.jsx(n.p,{}):g&&!e?l.jsx(o.d,{error:g}):u&&e&&a?l.jsx("div",{className:"container mx-auto py-6",children:l.jsx(s.W,{currentRecord:e,conflictingRecord:a,onResolve:v,onCancel:j})}):p&&e?l.jsx("div",{className:"container mx-auto py-6",children:l.jsx(i.B,{history:r,onRestore:b,onClose:E,isLoading:h})}):(0,l.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[l.jsx(c.b,{record:e,onShowHistory:R,isLoadingHistory:h}),g&&l.jsx(d.Zb,{children:l.jsx(d.aY,{className:"pt-6",children:l.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:g})})}),e&&l.jsx(t.v,{record:e,onSave:f,onCancel:y,isLoading:x})]})}var p=r(31694),x=r(31324),m=r(76344);function h({params:e}){let{record:a,conflictingRecord:r,history:t,showConflictResolution:s,showVersionHistory:i,isLoading:n,isLoadingRecord:o,isLoadingHistory:c,error:d,originalVersion:h,setShowConflictResolution:g,setShowVersionHistory:f,setConflictingRecord:y,checkForConflicts:v,loadHistory:j,router:b,setIsLoading:R,setError:E}=function(e){let a=(0,x.useRouter)(),{0:r,1:t}=(0,p.useState)(null),{0:s,1:i}=(0,p.useState)(null),{0:n,1:o}=(0,p.useState)([]),{0:c,1:d}=(0,p.useState)(!1),{0:l,1:u}=(0,p.useState)(!1),{0:h,1:g}=(0,p.useState)(!1),{0:f,1:y}=(0,p.useState)(!0),{0:v,1:j}=(0,p.useState)(!1),{0:b,1:R}=(0,p.useState)(null),{0:E,1:w}=(0,p.useState)(1),C=async()=>{try{let a=await m.c.checkForConflicts(e,E);if(a.success&&a.data?.hasConflict&&a.data.currentRecord)return i(a.data.currentRecord),d(!0),!0;return!1}catch(e){return e instanceof Error&&R(`Error checking conflicts: ${e.message}`),!1}},N=async()=>{try{j(!0);let a=await m.c.getRecordHistory(e);a.success&&a.data&&o(a.data)}catch(e){e instanceof Error&&R(`Error loading history: ${e.message}`)}finally{j(!1)}};return{record:r,conflictingRecord:s,history:n,showConflictResolution:c,showVersionHistory:l,isLoading:h,isLoadingRecord:f,isLoadingHistory:v,error:b,originalVersion:E,setRecord:t,setConflictingRecord:i,setShowConflictResolution:d,setShowVersionHistory:u,setIsLoading:g,setError:R,checkForConflicts:C,loadHistory:N,router:a}}(e.id),{handleSave:w,handleConflictResolve:C,handleRestoreVersion:N,handleCancel:P}=function({recordId:e,originalVersion:a,setIsLoading:r,setError:t,checkForConflicts:s,router:i}){return{handleSave:async n=>{try{if(r(!0),t(null),await s()){r(!1);return}let o=await m.c.updateRecordWithVersion(e,n,a);o.success?i.push("/data"):o.error?.code==="CONFLICT"?await s():t(o.error?.message||"Error al actualizar el registro")}catch(e){t("Error de conexi\xf3n al actualizar el registro"),e instanceof Error&&t(`Error de conexi\xf3n: ${e.message}`)}finally{r(!1)}},handleConflictResolve:async(a,s,n,o)=>{try{let c;switch(r(!0),t(null),a){case"current":c=s;break;case"incoming":c=n;break;case"merge":c=o}let d=await m.c.updateRecord(e,c);d.success?i.push("/data"):t(d.error?.message||"Error al resolver el conflicto")}catch(e){t("Error de conexi\xf3n al resolver el conflicto"),e instanceof Error&&t(`Error de conexi\xf3n: ${e.message}`)}finally{r(!1)}},handleRestoreVersion:async a=>{try{r(!0),t(null);let s=await m.c.updateRecord(e,{type:a.type,data:a.data,metadata:a.metadata});s.success?i.push("/data"):t(s.error?.message||"Error al restaurar la versi\xf3n")}catch(e){t("Error de conexi\xf3n al restaurar la versi\xf3n"),e instanceof Error&&t(`Error de conexi\xf3n: ${e.message}`)}finally{r(!1)}},handleCancel:()=>{i.push("/data")}}}({recordId:e.id,originalVersion:h,setIsLoading:R,setError:E,checkForConflicts:v,router:b}),S=async()=>{i||0!==t.length||await j(),f(!0)},_=async(e,t)=>{await C(e,a,r,t),g(!1)};return l.jsx(u,{record:a,conflictingRecord:r,history:t,showConflictResolution:s,showVersionHistory:i,isLoading:n,isLoadingRecord:o,isLoadingHistory:c,error:d,onSave:w,onCancel:P,onConflictResolve:_,onConflictCancel:()=>{g(!1),y(null)},onRestoreVersion:N,onShowHistory:S,onCloseHistory:()=>f(!1)})}},19534:(e,a,r)=>{"use strict";r.d(a,{b:()=>i});var t=r(16546),s=r(52166);function i({record:e,onShowHistory:a,isLoadingHistory:r}){return(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Editar Registro"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Modifique la informaci\xf3n del registro de datos"}),e&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["ID: ",e.id," | Tipo: ",e.type," | Versi\xf3n:"," ",e.metadata?.version||1]})]}),s.jsx("div",{className:"flex space-x-2",children:s.jsx(t.z,{variant:"outline",onClick:a,disabled:r,children:"Ver Historial"})})]})}},94456:(e,a,r)=>{"use strict";r.d(a,{B:()=>c});var t=r(27667),s=r(16546),i=r(27671),n=r(17785),o=r(52166);function c({history:e,showHistory:a,isLoadingHistory:r,onToggleHistory:c}){return(0,o.jsxs)(t.Zb,{children:[o.jsx(t.Ol,{children:(0,o.jsxs)("div",{className:"flex justify-between items-center",children:[o.jsx(t.ll,{children:"Historial"}),(0,o.jsxs)(s.z,{variant:"outline",size:"sm",onClick:c,isLoading:r,children:[a?"Ocultar":"Ver"," Historial"]})]})}),a&&o.jsx(t.aY,{children:e.length>0?o.jsx("div",{className:"space-y-3",children:e.map((e,a)=>(0,o.jsxs)("div",{className:"border-l-2 border-blue-200 pl-4",children:[(0,o.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["Versi\xf3n ",e.metadata?.version||a+1]}),o.jsx("div",{className:"text-xs text-gray-500",children:function(e){try{return(0,i.Q)(new Date(e),{addSuffix:!0,locale:n.es})}catch{return e}}(e.updatedAt)}),(0,o.jsxs)("div",{className:"text-xs text-gray-500",children:["por ",e.updatedBy]})]},a))}):o.jsx("p",{className:"text-sm text-gray-500",children:"No hay historial disponible"})})]})}},22373:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>t});let t=(0,r(87866).createProxy)(String.raw`/Users/mauroociappina/Desktop/Dazlab/Proyecto 40/Repo/gravitad-040-2024-gravitad-generacio-actualizada-contenido-asist-de-escritura-plataforma/Req/frontend/src/app/data/[id]/edit/page.tsx#default`)}};var a=require("../../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[588,361,909,741,37,52],()=>r(8309));module.exports=t})();