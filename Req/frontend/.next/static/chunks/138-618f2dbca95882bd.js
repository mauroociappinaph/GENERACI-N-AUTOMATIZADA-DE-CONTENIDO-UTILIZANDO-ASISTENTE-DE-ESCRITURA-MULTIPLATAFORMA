"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[138],{10138:function(e,r,t){t.d(r,{v:function(){return y}});var n=t(86583),a=t(84513),o=t(66859),i=t(50090),l=t(30837),s=t.n(l),c=t(2265),u=t(19245),d=t(55010),p=t(36118),f=t(43998),m=t(57437);function x(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function b(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?x(Object(t),!0).forEach(function(r){(0,a.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function y(e){var r,t,l,x,y=e.record,v=e.onSave,g=e.onCancel,h=e.isLoading,j=void 0!==h&&h,O=(0,c.useState)([]),k=O[0],N=O[1],w=(0,c.useState)({type:(null==y?void 0:y.type)||"",category:(null==y||null===(t=y.metadata)||void 0===t?void 0:t.category)||"",priority:(null==y||null===(l=y.metadata)||void 0===l?void 0:l.priority)||"medium",tags:(null==y||null===(x=y.metadata)||void 0===x||null===(x=x.tags)||void 0===x?void 0:x.join(", "))||""}),C=w[0],E=w[1],P=(0,c.useState)([]),_=P[0],S=P[1],Z=(0,c.useState)({}),D=Z[0],I=Z[1];(0,c.useEffect)(function(){var e;(e=(0,i.Z)(s().mark(function e(){var r;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.c.getRecordTypes();case 3:(r=e.sent).success&&r.data&&N(r.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error loading record types:",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])})),function(){return e.apply(this,arguments)})(),null!=y&&y.data?S(Object.entries(y.data).map(function(e){var r=(0,o.Z)(e,2),t=r[0],n=r[1];return{key:t,value:n,type:z(n)}})):S([{key:"",value:"",type:"text"}])},[y]);var z=function(e){if("boolean"==typeof e)return"boolean";if("number"==typeof e)return"number";if("string"==typeof e){if(e.includes("@"))return"email";if(e.startsWith("http"))return"url";if(e.match(/^\d{4}-\d{2}-\d{2}/))return"date"}return"text"},R=function(e,r){E(function(t){return b(b({},t),{},(0,a.Z)({},e,r))}),D[e]&&I(function(r){return b(b({},r),{},(0,a.Z)({},e,""))})},q=function(e,r,t){S(function(o){var i=(0,n.Z)(o);return i[e]=b(b({},i[e]),{},(0,a.Z)({},r,t)),i})},A=function(){S(function(e){return[].concat((0,n.Z)(e),[{key:"",value:"",type:"text"}])})},T=function(e){S(function(r){return r.filter(function(r,t){return t!==e})})},L=function(){var e={};C.type.trim()||(e.type="El tipo de registro es obligatorio"),_.forEach(function(r,t){r.key.trim()||(e["field_".concat(t,"_key")]="El nombre del campo es obligatorio"),(""===r.value||null===r.value||void 0===r.value)&&(e["field_".concat(t,"_value")]="El valor del campo es obligatorio")});var r=_.map(function(e){return e.key.trim()}).filter(function(e){return e}),t=r.filter(function(e,t){return r.indexOf(e)!==t});return t.length>0&&t.forEach(function(r){var t=_.findIndex(function(e){return e.key===r});e["field_".concat(t,"_key")]="El nombre del campo debe ser \xfanico"}),I(e),0===Object.keys(e).length},V=(r=(0,i.Z)(s().mark(function e(r){var t,n,a;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),L()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,n=_.reduce(function(e,r){if(r.key.trim()){var t=r.value;switch(r.type){case"number":t=Number(t);break;case"boolean":t=!!t;break;default:t=String(t)}e[r.key.trim()]=t}return e},{}),a={type:C.type,data:n,metadata:{version:(null==y||null===(t=y.metadata)||void 0===t?void 0:t.version)||1,category:C.category||void 0,priority:C.priority,tags:C.tags?C.tags.split(",").map(function(e){return e.trim()}).filter(function(e){return e}):void 0}},e.next=8,v(a);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Error saving record:",e.t0);case 13:case"end":return e.stop()}},e,null,[[3,10]])})),function(e){return r.apply(this,arguments)});return(0,m.jsxs)("form",{onSubmit:V,className:"space-y-6",children:[(0,m.jsxs)(p.Zb,{children:[(0,m.jsx)(p.Ol,{children:(0,m.jsx)(p.ll,{children:"Informaci\xf3n General"})}),(0,m.jsxs)(p.aY,{className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Registro *"}),k.length>0?(0,m.jsxs)("select",{className:"w-full h-10 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:C.type,onChange:function(e){return R("type",e.target.value)},required:!0,children:[(0,m.jsx)("option",{value:"",children:"Seleccionar tipo"}),k.map(function(e){return(0,m.jsx)("option",{value:e,children:e},e)})]}):(0,m.jsx)(d.I,{placeholder:"Ingrese el tipo de registro",value:C.type,onChange:function(e){return R("type",e.target.value)},error:D.type,required:!0}),D.type&&(0,m.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.type})]}),(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categor\xeda"}),(0,m.jsx)(d.I,{placeholder:"Categor\xeda del registro",value:C.category,onChange:function(e){return R("category",e.target.value)}})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),(0,m.jsxs)("select",{className:"w-full h-10 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:C.priority,onChange:function(e){return R("priority",e.target.value)},children:[(0,m.jsx)("option",{value:"low",children:"Baja"}),(0,m.jsx)("option",{value:"medium",children:"Media"}),(0,m.jsx)("option",{value:"high",children:"Alta"})]})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Etiquetas"}),(0,m.jsx)(d.I,{placeholder:"Etiquetas separadas por comas",value:C.tags,onChange:function(e){return R("tags",e.target.value)}}),(0,m.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Separe m\xfaltiples etiquetas con comas"})]})]})]}),(0,m.jsxs)(p.Zb,{children:[(0,m.jsx)(p.Ol,{children:(0,m.jsxs)("div",{className:"flex justify-between items-center",children:[(0,m.jsx)(p.ll,{children:"Datos del Registro"}),(0,m.jsx)(u.z,{type:"button",variant:"outline",size:"sm",onClick:A,children:"Agregar Campo"})]})}),(0,m.jsxs)(p.aY,{className:"space-y-4",children:[_.map(function(e,r){return(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 border border-gray-200 rounded-lg",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Campo *"}),(0,m.jsx)(d.I,{placeholder:"nombre_campo",value:e.key,onChange:function(e){return q(r,"key",e.target.value)},error:D["field_".concat(r,"_key")]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),(0,m.jsxs)("select",{className:"w-full h-10 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:e.type,onChange:function(e){return q(r,"type",e.target.value)},children:[(0,m.jsx)("option",{value:"text",children:"Texto"}),(0,m.jsx)("option",{value:"number",children:"N\xfamero"}),(0,m.jsx)("option",{value:"boolean",children:"Booleano"}),(0,m.jsx)("option",{value:"date",children:"Fecha"}),(0,m.jsx)("option",{value:"email",children:"Email"}),(0,m.jsx)("option",{value:"url",children:"URL"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor *"}),"boolean"===e.type?(0,m.jsxs)("select",{className:"w-full h-10 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:e.value.toString(),onChange:function(e){return q(r,"value","true"===e.target.value)},children:[(0,m.jsx)("option",{value:"true",children:"Verdadero"}),(0,m.jsx)("option",{value:"false",children:"Falso"})]}):(0,m.jsx)(d.I,{type:"number"===e.type?"number":"date"===e.type?"date":e.type,placeholder:"Valor del campo",value:e.value,onChange:function(e){return q(r,"value",e.target.value)},error:D["field_".concat(r,"_value")]})]}),(0,m.jsx)("div",{className:"flex items-end",children:(0,m.jsx)(u.z,{type:"button",variant:"outline",size:"sm",onClick:function(){return T(r)},disabled:1===_.length,className:"text-red-600 hover:text-red-700",children:"Eliminar"})})]},r)}),0===_.length&&(0,m.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,m.jsx)("p",{children:"No hay campos de datos definidos"}),(0,m.jsx)(u.z,{type:"button",variant:"outline",onClick:A,className:"mt-2",children:"Agregar Primer Campo"})]})]})]}),(0,m.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,m.jsx)(u.z,{type:"button",variant:"outline",onClick:g,disabled:j,children:"Cancelar"}),(0,m.jsxs)(u.z,{type:"submit",isLoading:j,children:[y?"Actualizar":"Crear"," Registro"]})]})]})}},55010:function(e,r,t){t.d(r,{I:function(){return u}});var n=t(84513),a=t(83366),o=t(39436),i=t(2265),l=t(57437),s=["className","error"];function c(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}var u=(0,i.forwardRef)(function(e,r){var t=e.className,i=e.error,u=(0,a.Z)(e,s);return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?c(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({className:(0,o.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50",i&&"border-red-500 focus:ring-red-500",t),ref:r},u)),i&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i})]})});u.displayName="Input"}}]);