"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[232],{7232:function(e,t,r){r.d(t,{Z:function(){return q}});var n,s=r(52133),a=r(32921),i=r(2265),o=r(69161),c=r(30229),l=r(57437);function u(e){var t=e.children,r=e.allowedRoles,n=e.fallbackPath,u=e.checkPathAccess,d=void 0===u||u,f=(0,s.t)(),h=f.user,p=f.isAuthenticated,m=f.isInitialized,x=(0,a.useRouter)(),g=(0,a.usePathname)(),v=(0,i.useCallback)(function(e){return n||(0,c.wP)(e)},[n]),b=(0,i.useCallback)(function(e){return!r||r.includes(e)},[r]),y=(0,i.useCallback)(function(e,t){return!d||(0,c.c1)(e,t)},[d]),j=(0,i.useCallback)(function(e){var t=v(e);x.push(t)},[v,x]);if((0,i.useEffect)(function(){if(m&&p&&h){if(!b(h.role)){j(h.role);return}y(g,h.role)||j(h.role)}},[h,p,r,n,x,g,d,m,b,y,j]),!m)return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsx)(o.g,{size:"lg"})});if(p&&h){var k=!r||r.includes(h.role),N=!d||(0,c.c1)(g,h.role);if(k&&N)return(0,l.jsx)(l.Fragment,{children:t})}return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsx)(o.g,{size:"lg"})})}var d=r(39436),f=r(19245),h=r(50090),p=r(84513),m=r(30837),x=r.n(m),g=r(86583),v=r(71703),b=r(27274),y=r(93394),j=r(35685),k=r(10026),N=r(84764),w=r(29738);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach(function(t){(0,p.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var D=new(function(){var e,t,r,n,s,a;function i(){(0,j.Z)(this,i),(0,p.Z)(this,"socket",null),(0,p.Z)(this,"isConnected",!1),(0,p.Z)(this,"reconnectAttempts",0),(0,p.Z)(this,"maxReconnectAttempts",5),(0,p.Z)(this,"reconnectDelay",1e3)}return(0,k.Z)(i,[{key:"connect",value:(e=(0,h.Z)(x().mark(function e(t,r){var n,s,a=this;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null!==(s=this.socket)&&void 0!==s&&s.connected)){e.next=2;break}return e.abrupt("return");case 2:return n="http://localhost:3001",this.socket=(0,N.io)(n,{auth:{token:r},transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:this.maxReconnectAttempts,reconnectionDelay:this.reconnectDelay}),this.setupEventHandlers(t),e.abrupt("return",new Promise(function(e,r){if(!a.socket){r(Error("Socket not initialized"));return}a.socket.on("connect",function(){var r;console.log("✅ Connected to notification service"),a.isConnected=!0,a.reconnectAttempts=0,null===(r=a.socket)||void 0===r||r.emit("join_user_room",t),e()}),a.socket.on("connect_error",function(e){console.error("❌ Failed to connect to notification service:",e),a.isConnected=!1,r(e)})}));case 6:case"end":return e.stop()}},e,this)})),function(t,r){return e.apply(this,arguments)})},{key:"setupEventHandlers",value:function(e){var t=this;this.socket&&(this.socket.on("notification",function(e){t.handleIncomingNotification(e)}),this.socket.on("notification_read",function(e){console.log("Notification marked as read:",e)}),this.socket.on("system_announcement",function(e){(0,w.ZP)(e,{icon:"\uD83D\uDCE2",duration:6e3,position:"top-center"})}),this.socket.on("reconnect",function(r){var n;console.log("\uD83D\uDD04 Reconnected to notification service (attempt ".concat(r,")")),t.isConnected=!0,null===(n=t.socket)||void 0===n||n.emit("join_user_room",e)}),this.socket.on("disconnect",function(e){console.log("\uD83D\uDD0C Disconnected from notification service:",e),t.isConnected=!1}))}},{key:"handleIncomingNotification",value:function(e){var t={duration:this.getToastDuration(e.type),position:"top-right"};switch(e.type){case y.k$.SUCCESS:w.ZP.success(e.message,E(E({},t),{},{icon:"✅"}));break;case y.k$.ERROR:w.ZP.error(e.message,E(E({},t),{},{icon:"❌"}));break;case y.k$.WARNING:(0,w.ZP)(e.message,E(E({},t),{},{icon:"⚠️"}));break;case y.k$.INFO:(0,w.ZP)(e.message,E(E({},t),{},{icon:"ℹ️"}));break;case y.k$.SYSTEM:(0,w.ZP)(e.message,E(E({},t),{},{icon:"\uD83D\uDD27"}));break;case y.k$.REPORT_READY:(0,w.ZP)(e.message,E(E({},t),{},{icon:"\uD83D\uDCCA"}));break;default:(0,w.ZP)(e.message,t)}window.dispatchEvent(new CustomEvent("notification-received",{detail:e}))}},{key:"getToastDuration",value:function(e){switch(e){case y.k$.ERROR:return 8e3;case y.k$.WARNING:return 6e3;case y.k$.SUCCESS:return 4e3;case y.k$.SYSTEM:return 1e4;default:return 5e3}}},{key:"getNotifications",value:(t=(0,h.Z)(x().mark(function e(){var t,r,n,s,a,i=arguments;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},e.prev=1,r=new URLSearchParams,t.type&&r.append("type",t.type),void 0!==t.read&&r.append("read",t.read.toString()),t.limit&&r.append("limit",t.limit.toString()),t.offset&&r.append("offset",t.offset.toString()),n="http://localhost:3001",e.next=10,fetch("".concat(n,"/api/notifications?").concat(r.toString()),{headers:{Authorization:"Bearer ".concat(this.getToken()),"Content-Type":"application/json"}});case 10:if(console.log("getNotifications - response status:",(s=e.sent).status),s.ok){e.next=14;break}throw Error("HTTP error! status: ".concat(s.status));case 14:return e.next=16,s.json();case 16:return console.log("getNotifications - response data:",a=e.sent),e.abrupt("return",a.data||[]);case 21:throw e.prev=21,e.t0=e.catch(1),console.error("Error fetching notifications:",e.t0),e.t0;case 25:case"end":return e.stop()}},e,this,[[1,21]])})),function(){return t.apply(this,arguments)})},{key:"getNotificationStats",value:(r=(0,h.Z)(x().mark(function e(){var t,r,n;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t="http://localhost:3001",e.next=4,fetch("".concat(t,"/api/notifications/stats"),{headers:{Authorization:"Bearer ".concat(this.getToken()),"Content-Type":"application/json"}});case 4:if((r=e.sent).ok){e.next=7;break}throw Error("HTTP error! status: ".concat(r.status));case 7:return e.next=9,r.json();case 9:return n=e.sent,e.abrupt("return",n.data||{total:0,unread:0,byType:{}});case 13:throw e.prev=13,e.t0=e.catch(0),console.error("Error fetching notification stats:",e.t0),e.t0;case 17:case"end":return e.stop()}},e,this,[[0,13]])})),function(){return r.apply(this,arguments)})},{key:"markAsRead",value:(n=(0,h.Z)(x().mark(function e(t){var r,n,s;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="http://localhost:3001",e.next=4,fetch("".concat(n,"/api/notifications/").concat(t,"/read"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(this.getToken()),"Content-Type":"application/json"}});case 4:if((s=e.sent).ok){e.next=7;break}throw Error("HTTP error! status: ".concat(s.status));case 7:null===(r=this.socket)||void 0===r||r.emit("mark_notification_read",t),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),console.error("Error marking notification as read:",e.t0),e.t0;case 14:case"end":return e.stop()}},e,this,[[0,10]])})),function(e){return n.apply(this,arguments)})},{key:"markAllAsRead",value:(s=(0,h.Z)(x().mark(function e(){var t,r,n,s;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="http://localhost:3001",e.next=4,fetch("".concat(r,"/api/notifications/mark-all-read"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(this.getToken()),"Content-Type":"application/json"}});case 4:if((n=e.sent).ok){e.next=7;break}throw Error("HTTP error! status: ".concat(n.status));case 7:return e.next=9,n.json();case 9:return s=e.sent,e.abrupt("return",(null===(t=s.data)||void 0===t?void 0:t.markedCount)||0);case 13:throw e.prev=13,e.t0=e.catch(0),console.error("Error marking all notifications as read:",e.t0),e.t0;case 17:case"end":return e.stop()}},e,this,[[0,13]])})),function(){return s.apply(this,arguments)})},{key:"deleteNotification",value:(a=(0,h.Z)(x().mark(function e(t){var r,n;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="http://localhost:3001",e.next=4,fetch("".concat(r,"/api/notifications/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(this.getToken()),"Content-Type":"application/json"}});case 4:if((n=e.sent).ok){e.next=7;break}throw Error("HTTP error! status: ".concat(n.status));case 7:e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),console.error("Error deleting notification:",e.t0),e.t0;case 13:case"end":return e.stop()}},e,this,[[0,9]])})),function(e){return a.apply(this,arguments)})},{key:"requestNotifications",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null!==(e=this.socket)&&void 0!==e&&e.connected&&this.socket.emit("get_notifications",t)}},{key:"disconnect",value:function(){this.socket&&(this.socket.disconnect(),this.socket=null,this.isConnected=!1)}},{key:"isSocketConnected",value:function(){var e;return this.isConnected&&(null===(e=this.socket)||void 0===e?void 0:e.connected)===!0}},{key:"getToken",value:function(){var e=localStorage.getItem("auth-storage");if(e)try{var t,r=JSON.parse(e);return(null===(t=r.state)||void 0===t?void 0:t.token)||""}catch(e){console.warn("Error parsing auth storage:",e)}return""}}]),i}());function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach(function(t){(0,p.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var R={total:0,unread:0,byType:(n={},(0,p.Z)(n,y.k$.INFO,0),(0,p.Z)(n,y.k$.SUCCESS,0),(0,p.Z)(n,y.k$.WARNING,0),(0,p.Z)(n,y.k$.ERROR,0),(0,p.Z)(n,y.k$.SYSTEM,0),(0,p.Z)(n,y.k$.USER_ACTION,0),(0,p.Z)(n,y.k$.DATA_UPDATE,0),(0,p.Z)(n,y.k$.REPORT_READY,0),n)},S=(0,v.Ue)()((0,b.mW)(function(e,t){var r,n,s,a,i,o;return{notifications:[],stats:R,isLoading:!1,isConnected:!1,error:null,initializeNotifications:(r=(0,h.Z)(x().mark(function r(n,s){return x().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e({isLoading:!0,error:null}),r.prev=1,r.next=4,D.connect(n,s);case 4:return e({isConnected:!0}),r.next=7,Promise.all([t().loadNotifications(),t().loadStats()]);case 7:window.addEventListener("notification-received",function(e){var r=e.detail;t().addNotification(r),t().loadStats()}),r.next=14;break;case 10:r.prev=10,r.t0=r.catch(1),console.error("Failed to initialize notifications:",r.t0),e({error:r.t0 instanceof Error?r.t0.message:"Failed to initialize notifications",isConnected:!1});case 14:return r.prev=14,e({isLoading:!1}),r.finish(14);case 17:case"end":return r.stop()}},r,null,[[1,10,14,17]])})),function(e,t){return r.apply(this,arguments)}),loadNotifications:(n=(0,h.Z)(x().mark(function t(){var r,n=arguments;return x().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>0&&void 0!==n[0]?n[0]:{},e({isLoading:!0,error:null}),t.prev=2,t.next=5,D.getNotifications(r);case 5:e({notifications:t.sent}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("Failed to load notifications:",t.t0),e({error:t.t0 instanceof Error?t.t0.message:"Failed to load notifications"});case 13:return t.prev=13,e({isLoading:!1}),t.finish(13);case 16:case"end":return t.stop()}},t,null,[[2,9,13,16]])})),function(){return n.apply(this,arguments)}),loadStats:(s=(0,h.Z)(x().mark(function t(){return x().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D.getNotificationStats();case 3:e({stats:t.sent}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Failed to load notification stats:",t.t0);case 10:case"end":return t.stop()}},t,null,[[0,7]])})),function(){return s.apply(this,arguments)}),markAsRead:(a=(0,h.Z)(x().mark(function r(n){return x().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,D.markAsRead(n);case 3:return e(function(e){return{notifications:e.notifications.map(function(e){return e.id===n?C(C({},e),{},{read:!0}):e})}}),r.next=6,t().loadStats();case 6:r.next=12;break;case 8:r.prev=8,r.t0=r.catch(0),console.error("Failed to mark notification as read:",r.t0),e({error:r.t0 instanceof Error?r.t0.message:"Failed to mark notification as read"});case 12:case"end":return r.stop()}},r,null,[[0,8]])})),function(e){return a.apply(this,arguments)}),markAllAsRead:(i=(0,h.Z)(x().mark(function r(){return x().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,D.markAllAsRead();case 3:if(!(r.sent>0)){r.next=8;break}return e(function(e){return{notifications:e.notifications.map(function(e){return C(C({},e),{},{read:!0})})}}),r.next=8,t().loadStats();case 8:r.next=14;break;case 10:r.prev=10,r.t0=r.catch(0),console.error("Failed to mark all notifications as read:",r.t0),e({error:r.t0 instanceof Error?r.t0.message:"Failed to mark all notifications as read"});case 14:case"end":return r.stop()}},r,null,[[0,10]])})),function(){return i.apply(this,arguments)}),deleteNotification:(o=(0,h.Z)(x().mark(function r(n){return x().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,D.deleteNotification(n);case 3:return e(function(e){return{notifications:e.notifications.filter(function(e){return e.id!==n})}}),r.next=6,t().loadStats();case 6:r.next=12;break;case 8:r.prev=8,r.t0=r.catch(0),console.error("Failed to delete notification:",r.t0),e({error:r.t0 instanceof Error?r.t0.message:"Failed to delete notification"});case 12:case"end":return r.stop()}},r,null,[[0,8]])})),function(e){return o.apply(this,arguments)}),addNotification:function(t){e(function(e){return{notifications:[t].concat((0,g.Z)(e.notifications))}})},updateNotification:function(t,r){e(function(e){return{notifications:e.notifications.map(function(e){return e.id===t?C(C({},e),r):e})}})},clearError:function(){e({error:null})},disconnect:function(){D.disconnect(),e({isConnected:!1,notifications:[],stats:R})}}},{name:"notification-store"})),P=r(29368),T=r(32090);function Z(e){var t,r,n=e.notification,s=S(),a=s.markAsRead,o=s.deleteNotification,c=(0,i.useState)(!1),u=c[0],d=c[1],p=(t=(0,h.Z)(x().mark(function e(){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.read){e.next=3;break}return e.next=3,a(n.id);case 3:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),m=(r=(0,h.Z)(x().mark(function e(){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,o(n.id);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("Error deleting notification:",e.t0);case 9:return e.prev=9,d(!1),e.finish(9);case 12:case"end":return e.stop()}},e,null,[[1,6,9,12]])})),function(){return r.apply(this,arguments)}),g=function(e){try{return(0,P.Q)(new Date(e),{addSuffix:!0,locale:T.es})}catch(e){return"Fecha inv\xe1lida"}};return(0,l.jsx)("div",{className:"p-4 hover:bg-gray-50 transition-colors ".concat(n.read?"":"bg-blue-50 border-l-4 border-blue-400"),children:(0,l.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm ".concat(function(e){switch(e){case y.k$.SUCCESS:return"text-green-600 bg-green-50 border-green-200";case y.k$.ERROR:return"text-red-600 bg-red-50 border-red-200";case y.k$.WARNING:return"text-yellow-600 bg-yellow-50 border-yellow-200";case y.k$.INFO:return"text-blue-600 bg-blue-50 border-blue-200";case y.k$.SYSTEM:return"text-purple-600 bg-purple-50 border-purple-200";case y.k$.USER_ACTION:return"text-indigo-600 bg-indigo-50 border-indigo-200";case y.k$.DATA_UPDATE:return"text-teal-600 bg-teal-50 border-teal-200";case y.k$.REPORT_READY:return"text-orange-600 bg-orange-50 border-orange-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}}(n.type)),children:function(e){switch(e){case y.k$.SUCCESS:return"✅";case y.k$.ERROR:return"❌";case y.k$.WARNING:return"⚠️";case y.k$.INFO:return"ℹ️";case y.k$.SYSTEM:return"\uD83D\uDD27";case y.k$.USER_ACTION:return"\uD83D\uDC64";case y.k$.DATA_UPDATE:return"\uD83D\uDCDD";case y.k$.REPORT_READY:return"\uD83D\uDCCA";default:return"\uD83D\uDD14"}}(n.type)}),(0,l.jsx)("div",{className:"flex-1 min-w-0",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h4",{className:"text-sm font-medium ".concat(n.read?"text-gray-700":"text-gray-900"),children:n.title}),(0,l.jsx)("p",{className:"mt-1 text-sm ".concat(n.read?"text-gray-600":"text-gray-800"),children:n.message}),n.data&&Object.keys(n.data).length>0&&(0,l.jsx)("div",{className:"mt-2 p-2 bg-gray-100 rounded text-xs",children:(0,l.jsxs)("details",{children:[(0,l.jsx)("summary",{className:"cursor-pointer text-gray-600 hover:text-gray-800",children:"Ver detalles"}),(0,l.jsx)("pre",{className:"mt-2 text-gray-700 whitespace-pre-wrap",children:JSON.stringify(n.data,null,2)})]})}),(0,l.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-xs text-gray-500",children:[(0,l.jsx)("span",{children:g(n.createdAt)}),(0,l.jsx)("span",{className:"capitalize",children:n.type}),n.expiresAt&&(0,l.jsxs)("span",{children:["Expira: ",g(n.expiresAt)]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[!n.read&&(0,l.jsxs)(f.z,{variant:"ghost",size:"sm",onClick:p,className:"text-blue-600 hover:text-blue-800 hover:bg-blue-100",title:"Marcar como le\xedda",children:[(0,l.jsx)("span",{className:"sr-only",children:"Marcar como le\xedda"}),"\uD83D\uDC41️"]}),(0,l.jsxs)(f.z,{variant:"ghost",size:"sm",onClick:m,disabled:u,className:"text-red-600 hover:text-red-800 hover:bg-red-100",title:"Eliminar notificaci\xf3n",children:[(0,l.jsx)("span",{className:"sr-only",children:"Eliminar"}),u?"⏳":"\uD83D\uDDD1️"]})]})]})})]})})}function $(e){var t=e.filter,r=e.onChange,n=[{value:"",label:"Todos los tipos"},{value:y.k$.INFO,label:"Informaci\xf3n"},{value:y.k$.SUCCESS,label:"\xc9xito"},{value:y.k$.WARNING,label:"Advertencia"},{value:y.k$.ERROR,label:"Error"},{value:y.k$.SYSTEM,label:"Sistema"},{value:y.k$.USER_ACTION,label:"Acci\xf3n de usuario"},{value:y.k$.DATA_UPDATE,label:"Actualizaci\xf3n de datos"},{value:y.k$.REPORT_READY,label:"Reporte listo"}],s=function(e){r({type:""===e?void 0:e})},a=function(e){r({limit:e})};return(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("label",{htmlFor:"notification-type",className:"text-sm font-medium text-gray-700",children:"Tipo:"}),(0,l.jsx)("select",{id:"notification-type",value:t.type||"",onChange:function(e){return s(e.target.value)},className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:n.map(function(e){return(0,l.jsx)("option",{value:e.value,children:e.label},e.value)})})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("label",{htmlFor:"notification-limit",className:"text-sm font-medium text-gray-700",children:"Mostrar:"}),(0,l.jsxs)("select",{id:"notification-limit",value:t.limit||20,onChange:function(e){return a(parseInt(e.target.value,10))},className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:10,children:"10"}),(0,l.jsx)("option",{value:20,children:"20"}),(0,l.jsx)("option",{value:50,children:"50"}),(0,l.jsx)("option",{value:100,children:"100"})]})]}),(t.type||t.limit&&20!==t.limit)&&(0,l.jsx)("button",{onClick:function(){return r({type:void 0,limit:20})},className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Limpiar filtros"})]})}var I=r(66859);function M(e){var t=e.stats,r=function(e){switch(e){case y.k$.INFO:return"Info";case y.k$.SUCCESS:return"\xc9xito";case y.k$.WARNING:return"Advertencia";case y.k$.ERROR:return"Error";case y.k$.SYSTEM:return"Sistema";case y.k$.USER_ACTION:return"Usuario";case y.k$.DATA_UPDATE:return"Datos";case y.k$.REPORT_READY:return"Reportes";default:return e}},n=function(e){switch(e){case y.k$.INFO:return"ℹ️";case y.k$.SUCCESS:return"✅";case y.k$.WARNING:return"⚠️";case y.k$.ERROR:return"❌";case y.k$.SYSTEM:return"\uD83D\uDD27";case y.k$.USER_ACTION:return"\uD83D\uDC64";case y.k$.DATA_UPDATE:return"\uD83D\uDCDD";case y.k$.REPORT_READY:return"\uD83D\uDCCA";default:return"\uD83D\uDD14"}},s=function(e){switch(e){case y.k$.SUCCESS:return"text-green-600 bg-green-100";case y.k$.ERROR:return"text-red-600 bg-red-100";case y.k$.WARNING:return"text-yellow-600 bg-yellow-100";case y.k$.INFO:return"text-blue-600 bg-blue-100";case y.k$.SYSTEM:return"text-purple-600 bg-purple-100";case y.k$.USER_ACTION:return"text-indigo-600 bg-indigo-100";case y.k$.DATA_UPDATE:return"text-teal-600 bg-teal-100";case y.k$.REPORT_READY:return"text-orange-600 bg-orange-100";default:return"text-gray-600 bg-gray-100"}},a=Object.entries(t.byType).filter(function(e){var t=(0,I.Z)(e,2);return t[0],t[1]>0});return(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,l.jsx)("span",{className:"font-medium",children:t.total})," total"]}),t.unread>0&&(0,l.jsxs)("div",{className:"text-sm text-red-600",children:[(0,l.jsx)("span",{className:"font-medium",children:t.unread})," sin leer"]})]}),t.total>0&&(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[Math.round(t.unread/t.total*100),"% sin leer"]})]}),a.length>0&&(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:a.map(function(e){var t=(0,I.Z)(e,2),a=t[0],i=t[1];return(0,l.jsxs)("div",{className:"flex items-center space-x-2 px-2 py-1 rounded-md text-xs ".concat(s(a)),children:[(0,l.jsx)("span",{children:n(a)}),(0,l.jsx)("span",{className:"font-medium",children:i}),(0,l.jsx)("span",{className:"truncate",children:r(a)})]},a)})}),t.total>0&&(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Math.max(5,(t.total-t.unread)/t.total*100),"%")}})})]})}var z=r(36118);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach(function(t){(0,p.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function U(e){var t,r=e.isOpen,n=e.onClose,s=S(),a=s.notifications,c=s.stats,u=s.isLoading,d=s.error,p=s.loadNotifications,m=s.markAllAsRead,g=s.clearError,v=(0,i.useState)({limit:20,offset:0}),b=v[0],y=v[1],j=(0,i.useState)("all"),k=j[0],N=j[1];(0,i.useEffect)(function(){r&&p(L(L({},b),{},{read:"unread"!==k&&void 0}))},[r,k,b,p]);var w=function(e){N(e),y(function(e){return L(L({},e),{},{offset:0})})},O=(t=(0,h.Z)(x().mark(function e(){return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:p(L(L({},b),{},{read:"unread"!==k&&void 0}));case 3:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)});return r?(0,l.jsx)("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,l.jsxs)(z.Zb,{className:"w-full max-w-2xl max-h-[80vh] bg-white rounded-lg shadow-xl",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Centro de Notificaciones"}),c.unread>0&&(0,l.jsx)("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:c.unread})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[c.unread>0&&(0,l.jsx)(f.z,{variant:"outline",size:"sm",onClick:O,disabled:u,children:"Marcar todas como le\xeddas"}),(0,l.jsx)(f.z,{variant:"ghost",size:"sm",onClick:n,className:"text-gray-500 hover:text-gray-700",children:"✕"})]})]}),(0,l.jsx)("div",{className:"p-4 border-b bg-gray-50",children:(0,l.jsx)(M,{stats:c})}),(0,l.jsxs)("div",{className:"flex border-b",children:[(0,l.jsxs)("button",{className:"flex-1 py-3 px-4 text-sm font-medium ".concat("all"===k?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),onClick:function(){return w("all")},children:["Todas (",c.total,")"]}),(0,l.jsxs)("button",{className:"flex-1 py-3 px-4 text-sm font-medium ".concat("unread"===k?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),onClick:function(){return w("unread")},children:["No le\xeddas (",c.unread,")"]})]}),(0,l.jsx)("div",{className:"p-4 border-b",children:(0,l.jsx)($,{filter:b,onChange:function(e){y(function(t){return L(L(L({},t),e),{},{offset:0})})}})}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto max-h-96",children:[d&&(0,l.jsx)("div",{className:"p-4 bg-red-50 border-l-4 border-red-400",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("span",{className:"text-red-400",children:"⚠️"})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("p",{className:"text-sm text-red-700",children:d}),(0,l.jsx)(f.z,{variant:"ghost",size:"sm",onClick:g,className:"mt-2 text-red-600 hover:text-red-800",children:"Cerrar"})]})]})}),u&&0===a.length?(0,l.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,l.jsx)(o.g,{})}):0===a.length?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-gray-500",children:[(0,l.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDD14"}),(0,l.jsx)("p",{className:"text-lg font-medium",children:"No hay notificaciones"}),(0,l.jsx)("p",{className:"text-sm",children:"unread"===k?"No tienes notificaciones sin leer":"No tienes notificaciones"})]}):(0,l.jsx)("div",{className:"divide-y divide-gray-200",children:a.map(function(e){return(0,l.jsx)(Z,{notification:e},e.id)})}),a.length>0&&a.length>=(b.limit||20)&&(0,l.jsx)("div",{className:"p-4 text-center border-t",children:(0,l.jsx)(f.z,{variant:"outline",onClick:function(){y(function(e){return L(L({},e),{},{offset:(e.offset||0)+(e.limit||20)})})},disabled:u,children:u?"Cargando...":"Cargar m\xe1s"})})]})]})}):null}function F(){var e,t,r,n,a,o,c,u,d,h,p,m,x,g=(0,i.useState)(!1),v=g[0],b=g[1],y=(t=(e=(0,s.t)()).user,r=e.token,n=e.isAuthenticated,o=(a=S()).notifications,c=a.stats,u=a.isLoading,d=a.isConnected,h=a.error,p=a.initializeNotifications,m=a.disconnect,x=a.clearError,(0,i.useEffect)(function(){return n&&t&&r?p(t.id,r):m(),function(){n||m()}},[n,t,r,p,m]),{notifications:o,stats:c,isLoading:u,isConnected:d,error:h,clearError:(0,i.useCallback)(function(){x()},[x]),hasUnreadNotifications:c.unread>0,unreadCount:c.unread}),j=y.unreadCount,k=y.isConnected;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(f.z,{variant:"ghost",size:"sm",onClick:function(){b(!v)},className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100",title:"Notificaciones",children:[(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),j>0&&(0,l.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:j>99?"99+":j}),(0,l.jsx)("span",{className:"absolute bottom-0 right-0 w-2 h-2 rounded-full ".concat(k?"bg-green-400":"bg-gray-400"),title:k?"Conectado":"Desconectado"})]}),(0,l.jsx)(U,{isOpen:v,onClose:function(){b(!1)}})]})}var W=r(73880);function G(e){var t=e.className,r=e.user,n=e.onLogout,s=e.onMenuClick,a=(0,i.useState)(!1),o=a[0],c=a[1],u=(0,i.useRef)(null),f=(0,i.useRef)(null);return(0,i.useEffect)(function(){function e(e){u.current&&f.current&&!u.current.contains(e.target)&&!f.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[]),(0,l.jsxs)("header",{className:(0,d.cn)("bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-between",t),children:[(0,l.jsx)("div",{className:"flex items-center md:hidden",children:(0,l.jsx)("button",{type:"button",className:"text-gray-500 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 p-2 rounded-md",onClick:s,"aria-label":"Open menu",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})}),(0,l.jsx)("div",{className:"flex-1 flex justify-end",children:(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)(F,{}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("button",{ref:f,type:"button",className:"flex items-center space-x-2 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-full p-1",onClick:function(){return c(!o)},"aria-expanded":o,"aria-haspopup":"true",children:[(0,l.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center text-gray-600",children:r?r.firstName.charAt(0)+r.lastName.charAt(0):"U"}),(0,l.jsx)("span",{className:"hidden md:block text-sm font-medium text-gray-700",children:r?"".concat(r.firstName," ").concat(r.lastName):"Usuario"}),(0,l.jsx)("svg",{className:"hidden md:block h-4 w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),o&&(0,l.jsx)("div",{ref:u,className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 border border-gray-200",role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu",children:r?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-700 border-b border-gray-200",children:[(0,l.jsx)("p",{className:"font-medium",children:"".concat(r.firstName," ").concat(r.lastName)}),(0,l.jsx)("p",{className:"text-gray-500",children:r.email}),(0,l.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Rol: ",r.role]})]}),(0,l.jsx)(W.default,{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){return c(!1)},role:"menuitem",children:"Mi perfil"}),(0,l.jsx)(W.default,{href:"/settings",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){return c(!1)},role:"menuitem",children:"Configuraci\xf3n"}),(0,l.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){c(!1),null==n||n()},role:"menuitem",children:"Cerrar sesi\xf3n"})]}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(W.default,{href:"/login",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:function(){return c(!1)},role:"menuitem",children:"Iniciar sesi\xf3n"})})})]})]})})]})}function Y(e){var t=e.className,r=e.userRole,n=(0,a.usePathname)(),s=(0,c.EH)(c.Hc,r);return(0,l.jsxs)("div",{className:(0,d.cn)("flex flex-col h-full bg-gray-900 text-white w-64",t),children:[(0,l.jsx)("div",{className:"p-4",children:(0,l.jsx)("h1",{className:"text-xl font-bold",children:"Sistema de Gesti\xf3n"})}),(0,l.jsx)("nav",{className:"flex-1 px-2 py-4 space-y-1 overflow-y-auto",children:s.map(function(e){return(0,l.jsx)(H,{item:e,pathname:n},e.href)})}),(0,l.jsx)("div",{className:"p-4 border-t border-gray-800",children:(0,l.jsx)("p",{className:"text-sm text-gray-400",children:"\xa9 2025 Sistema de Gesti\xf3n"})})]})}function H(e){var t=e.item,r=e.pathname,n=r===t.href,s=r.startsWith("".concat(t.href,"/")),a=t.children&&t.children.length>0,o=(0,i.useState)(n||s),c=o[0],u=o[1];return(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)(W.default,{href:t.href,className:(0,d.cn)("flex flex-1 items-center px-4 py-2 text-sm font-medium rounded-md transition-colors",n||s?"bg-gray-800 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"),children:[t.icon&&(0,l.jsx)(B,{name:t.icon,className:"mr-3 h-5 w-5"}),(0,l.jsx)("span",{className:"flex-1",children:t.name})]}),a&&(0,l.jsx)("button",{onClick:function(){return u(!c)},className:"p-2 rounded-md text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none","aria-label":c?"Collapse":"Expand",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:(0,d.cn)("h-4 w-4 transition-transform",c?"transform rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),a&&c&&(0,l.jsx)("div",{className:"ml-6 space-y-1 border-l border-gray-700 pl-2",children:t.children.map(function(e){return(0,l.jsx)(W.default,{href:e.href,className:(0,d.cn)("flex items-center px-4 py-2 text-sm font-medium rounded-md transition-colors",r===e.href?"bg-gray-800 text-white":"text-gray-400 hover:bg-gray-700 hover:text-white"),title:e.description,children:e.name},e.href)})})]})}function B(e){var t=e.name,r=e.className;return({dashboard:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[(0,l.jsx)("rect",{x:"3",y:"3",width:"7",height:"7"}),(0,l.jsx)("rect",{x:"14",y:"3",width:"7",height:"7"}),(0,l.jsx)("rect",{x:"14",y:"14",width:"7",height:"7"}),(0,l.jsx)("rect",{x:"3",y:"14",width:"7",height:"7"})]}),database:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[(0,l.jsx)("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),(0,l.jsx)("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),(0,l.jsx)("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"})]}),chart:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[(0,l.jsx)("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),(0,l.jsx)("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),(0,l.jsx)("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),settings:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[(0,l.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,l.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})[t]||null}function V(e){var t=e.children,r=e.user,n=e.onLogout;return(0,l.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,l.jsx)(Y,{userRole:null==r?void 0:r.role,className:"hidden md:block"}),(0,l.jsxs)("div",{className:"flex flex-col flex-1 overflow-hidden",children:[(0,l.jsx)(G,{user:r,onLogout:n}),(0,l.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:t})]})]})}function q(e){var t=e.children,r=e.allowedRoles,n=e.title,i=e.requireAuth,o=e.checkPathAccess,d=(0,s.t)(),f=d.user,h=d.logout,p=(0,a.useRouter)();return void 0===i||i?(0,l.jsx)(u,{allowedRoles:r,fallbackPath:f?(0,c.wP)(f.role):"/login",checkPathAccess:void 0===o||o,children:(0,l.jsxs)(V,{user:f,onLogout:function(){h(),p.push("/login")},children:[n&&(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:n})}),t]})}):(0,l.jsx)(l.Fragment,{children:t})}},19245:function(e,t,r){r.d(t,{z:function(){return d}});var n=r(84513),s=r(83366),a=r(39436),i=r(2265),o=r(57437),c=["className","children","variant","size","isLoading","disabled"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var d=(0,i.forwardRef)(function(e,t){var r=e.className,n=e.children,i=e.variant,l=e.size,d=e.isLoading,f=void 0!==d&&d,h=e.disabled,p=(0,s.Z)(e,c);return(0,o.jsxs)("button",u(u({className:(0,a.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{default:"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-500",primary:"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-500",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus-visible:ring-gray-500",outline:"border border-gray-300 bg-transparent hover:bg-gray-100 focus-visible:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 focus-visible:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus-visible:ring-red-500"}[void 0===i?"primary":i],{sm:"h-8 px-3 text-xs",md:"h-10 px-4 py-2",lg:"h-12 px-6 py-3 text-lg"}[void 0===l?"md":l],f&&"opacity-70 cursor-not-allowed",r),disabled:h||f,ref:t},p),{},{children:[f&&(0,o.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]}))});d.displayName="Button"},36118:function(e,t,r){r.d(t,{Ol:function(){return g},SZ:function(){return b},Zb:function(){return x},aY:function(){return y},eW:function(){return j},ll:function(){return v}});var n=r(84513),s=r(83366),a=r(39436),i=r(2265),o=r(57437),c=["className"],l=["className"],u=["className"],d=["className"],f=["className"],h=["className"];function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var x=(0,i.forwardRef)(function(e,t){var r=e.className,n=(0,s.Z)(e,c);return(0,o.jsx)("div",m({ref:t,className:(0,a.cn)("rounded-lg border border-gray-200 bg-white shadow-sm",r)},n))});x.displayName="Card";var g=(0,i.forwardRef)(function(e,t){var r=e.className,n=(0,s.Z)(e,l);return(0,o.jsx)("div",m({ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r)},n))});g.displayName="CardHeader";var v=(0,i.forwardRef)(function(e,t){var r=e.className,n=(0,s.Z)(e,u);return(0,o.jsx)("h3",m({ref:t,className:(0,a.cn)("text-lg font-semibold leading-none tracking-tight",r)},n))});v.displayName="CardTitle";var b=(0,i.forwardRef)(function(e,t){var r=e.className,n=(0,s.Z)(e,d);return(0,o.jsx)("p",m({ref:t,className:(0,a.cn)("text-sm text-gray-500",r)},n))});b.displayName="CardDescription";var y=(0,i.forwardRef)(function(e,t){var r=e.className,n=(0,s.Z)(e,f);return(0,o.jsx)("div",m({ref:t,className:(0,a.cn)("p-6 pt-0",r)},n))});y.displayName="CardContent";var j=(0,i.forwardRef)(function(e,t){var r=e.className,n=(0,s.Z)(e,h);return(0,o.jsx)("div",m({ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r)},n))});j.displayName="CardFooter"},69161:function(e,t,r){r.d(t,{g:function(){return a}});var n=r(39436),s=r(57437);function a(e){var t=e.size,r=e.className;return(0,s.jsx)("div",{className:"flex justify-center items-center",children:(0,s.jsx)("div",{className:(0,n.cn)("animate-spin rounded-full border-t-transparent border-blue-600",{sm:"h-4 w-4 border-2",md:"h-6 w-6 border-2",lg:"h-8 w-8 border-3"}[void 0===t?"md":t],r)})})}},30229:function(e,t,r){r.d(t,{EH:function(){return c},Hc:function(){return o},c1:function(){return l},wP:function(){return u}});var n=r(84513),s=r(93394);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var o=[{name:"Dashboard",href:"/dashboard",icon:"dashboard",description:"Vista general del sistema"},{name:"Registros",href:"/records",icon:"database",description:"Gesti\xf3n de datos y registros",roles:[s.i4.ADMIN,s.i4.MANAGER,s.i4.USER],children:[{name:"Todos los registros",href:"/records",description:"Ver todos los registros"},{name:"Crear registro",href:"/records/new",description:"Crear un nuevo registro",roles:[s.i4.ADMIN,s.i4.MANAGER,s.i4.USER]},{name:"B\xfasqueda avanzada",href:"/records/search",description:"B\xfasqueda avanzada de registros"}]},{name:"Reportes",href:"/reports",icon:"chart",description:"Generaci\xf3n y visualizaci\xf3n de reportes",roles:[s.i4.ADMIN,s.i4.MANAGER],children:[{name:"Reportes disponibles",href:"/reports",description:"Ver reportes disponibles"},{name:"Crear reporte",href:"/reports/create",description:"Crear un nuevo reporte",roles:[s.i4.ADMIN,s.i4.MANAGER]},{name:"Reportes programados",href:"/reports/scheduled",description:"Ver reportes programados",roles:[s.i4.ADMIN,s.i4.MANAGER]}]},{name:"Administraci\xf3n",href:"/admin",icon:"settings",description:"Configuraci\xf3n y administraci\xf3n del sistema",roles:[s.i4.ADMIN],children:[{name:"Usuarios",href:"/admin/users",description:"Gesti\xf3n de usuarios"},{name:"Configuraci\xf3n",href:"/admin/settings",description:"Configuraci\xf3n del sistema"},{name:"Auditor\xeda",href:"/admin/audit",description:"Logs de auditor\xeda"}]}];function c(e,t){return t?e.filter(function(e){return!e.roles||e.roles.includes(t)}).map(function(e){return e.children?i(i({},e),{},{children:e.children.filter(function(e){return!e.roles||e.roles.includes(t)})}):e}):e.filter(function(e){return!e.roles})}function l(e,t){if(!t)return!1;if(t===s.i4.ADMIN)return!0;var r="/"+e.split("/")[1];if(!((a={},(0,n.Z)(a,s.i4.ADMIN,["/admin","/reports","/records","/dashboard"]),(0,n.Z)(a,s.i4.MANAGER,["/reports","/records","/dashboard"]),(0,n.Z)(a,s.i4.USER,["/records","/dashboard"]),(0,n.Z)(a,s.i4.VIEWER,["/dashboard"]),a)[t]||[]).includes(r))return!1;if(e!==r){var a,i,c=e.split("/").slice(0,3).join("/"),l=o.find(function(e){return e.href===r}),u=null==l||null===(i=l.children)||void 0===i?void 0:i.find(function(e){return e.href===c});if(u&&u.roles&&!u.roles.includes(t))return!1}return!0}function u(e){var t;return e?(t={},(0,n.Z)(t,s.i4.ADMIN,"/dashboard"),(0,n.Z)(t,s.i4.MANAGER,"/dashboard"),(0,n.Z)(t,s.i4.USER,"/dashboard"),(0,n.Z)(t,s.i4.VIEWER,"/dashboard"),t)[e]||"/dashboard":"/login"}},39436:function(e,t,r){r.d(t,{cn:function(){return a}});var n=r(20487),s=r(63932);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}},52133:function(e,t,r){r.d(t,{t:function(){return i}});var n=r(84513);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var i=(0,r(71703).Ue)()(function(e){return{user:null,token:null,isAuthenticated:!1,isLoading:!1,isInitialized:!1,login:function(t,r){return e({token:t,user:r,isAuthenticated:!0,isLoading:!1,isInitialized:!0})},logout:function(){return e({token:null,user:null,isAuthenticated:!1,isInitialized:!0})},setLoading:function(t){return e({isLoading:t})},updateUser:function(t){return e(function(e){return{user:e.user?a(a({},e.user),t):null}})},initialize:function(t,r,n){return e({user:t,token:r,isAuthenticated:n,isInitialized:!0})}}})},93394:function(e,t,r){r.d(t,{i4:function(){return a},k$:function(){return i}});var n,s,a=((n={}).ADMIN="ADMIN",n.MANAGER="MANAGER",n.USER="USER",n.VIEWER="VIEWER",n),i=((s={}).INFO="info",s.SUCCESS="success",s.WARNING="warning",s.ERROR="error",s.SYSTEM="system",s.USER_ACTION="user_action",s.DATA_UPDATE="data_update",s.REPORT_READY="report_ready",s)}}]);