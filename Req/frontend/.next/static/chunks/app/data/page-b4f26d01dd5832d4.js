(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[315],{95266:function(e,r,t){Promise.resolve().then(t.bind(t,78463))},78463:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return b}});var n=t(84513),s=t(50090),i=t(30837),a=t.n(i),c=t(2265),o=t(32921),l=t(43998),u=t(75413),d=t(25346),f=t(36118),p=t(19245),h=t(55010),x=t(12693),g=t(21594),j=t(57437);function m(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?m(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function b(){var e,r,t=(0,o.useRouter)(),n=(0,c.useState)([]),i=n[0],m=n[1],b=(0,c.useState)(!0),y=b[0],O=b[1],E=(0,c.useState)(null),w=E[0],N=E[1],k=(0,c.useState)(""),C=k[0],P=k[1],S=(0,c.useState)({page:1,limit:20,total:0,totalPages:0}),D=S[0],R=S[1],_=(0,c.useState)({query:"",filters:{},sortBy:"updatedAt",sortOrder:"desc",page:1,limit:20}),A=_[0],B=_[1],Z=(0,c.useState)(null),q=Z[0],z=Z[1],F=(0,c.useState)(!1),Y=F[0],T=F[1],G=(0,c.useCallback)((e=(0,s.Z)(a().mark(function e(r){var t,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,O(!0),N(null),e.next=5,l.c.getRecords(r);case 5:(t=e.sent).success&&t.data?(m(t.data.records),R(t.data.pagination)):N((null===(n=t.error)||void 0===n?void 0:n.message)||"Error al cargar los registros"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),N("Error de conexi\xf3n al cargar los registros"),e.t0 instanceof Error&&N("Error de conexi\xf3n: ".concat(e.t0.message));case 13:return e.prev=13,O(!1),e.finish(13);case 16:case"end":return e.stop()}},e,null,[[0,9,13,16]])})),function(r){return e.apply(this,arguments)}),[]);(0,c.useEffect)(function(){G(A)},[A,G]);var I=function(e){P(e),B(function(r){return v(v({},r),{},{query:e,page:1})})},V=(r=(0,s.Z)(a().mark(function e(){var r,t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(q){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,l.c.deleteRecord(q.id);case 5:(r=e.sent).success?((0,x.A)({title:"Registro eliminado",description:'El registro "'.concat(q.id,'" fue eliminado correctamente.')}),G(A)):(0,x.A)({title:"Error al eliminar",description:(null===(t=r.error)||void 0===t?void 0:t.message)||"Error desconocido.",variant:"destructive"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),(0,x.A)({title:"Error de conexi\xf3n",description:e.t0 instanceof Error?e.t0.message:"Error desconocido.",variant:"destructive"});case 12:return e.prev=12,T(!1),z(null),e.finish(12);case 16:case"end":return e.stop()}},e,null,[[2,9,12,16]])})),function(){return r.apply(this,arguments)});return(0,j.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,j.jsxs)("div",{className:"flex justify-between items-center",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gesti\xf3n de Datos"}),(0,j.jsx)("p",{className:"text-gray-600 mt-1",children:"Administre y consulte los registros de datos del sistema"})]}),(0,j.jsx)(p.z,{onClick:function(){t.push("/data/new")},children:"Crear Nuevo Registro"})]}),(0,j.jsxs)(f.Zb,{children:[(0,j.jsx)(f.Ol,{children:(0,j.jsx)(f.ll,{children:"B\xfasqueda y Filtros"})}),(0,j.jsxs)(f.aY,{className:"space-y-4",children:[(0,j.jsx)("div",{className:"flex gap-4",children:(0,j.jsx)("div",{className:"flex-1",children:(0,j.jsx)(h.I,{placeholder:"Buscar registros...",value:C,onChange:function(e){return I(e.target.value)}})})}),(0,j.jsx)(d.P,{onFilterChange:function(e){B(function(r){return v(v({},r),{},{filters:e,page:1})})},currentFilters:A.filters})]})]}),(0,j.jsxs)(f.Zb,{children:[(0,j.jsx)(f.Ol,{children:(0,j.jsx)("div",{className:"flex justify-between items-center",children:(0,j.jsxs)(f.ll,{children:["Registros de Datos",D.total>0&&(0,j.jsxs)("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",D.total," registros)"]})]})})}),(0,j.jsxs)(f.aY,{children:[w&&(0,j.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:w}),(0,j.jsx)(u.w,{records:i,loading:y,pagination:D,sortBy:A.sortBy,sortOrder:A.sortOrder,onSortChange:function(e,r){B(function(t){return v(v({},t),{},{sortBy:e,sortOrder:r,page:1})})},onPageChange:function(e){B(function(r){return v(v({},r),{},{page:e})})},onView:function(e){t.push("/data/".concat(e))},onEdit:function(e){t.push("/data/".concat(e,"/edit"))},onDelete:function(e){z(i.find(function(r){return r.id===e})||null),T(!0)}})]})]}),(0,j.jsx)(g.aR,{open:Y,onOpenChange:T,children:(0,j.jsxs)(g._T,{children:[(0,j.jsxs)(g.fY,{children:[(0,j.jsx)(g.f$,{children:"\xbfEliminar registro?"}),(0,j.jsxs)(g.yT,{children:["Esta acci\xf3n no se puede deshacer. El registro"," ",(0,j.jsx)("span",{className:"font-semibold",children:(null==q?void 0:q.id)||"N/A"})," ","ser\xe1 eliminado permanentemente."]})]}),(0,j.jsxs)(g.xo,{children:[(0,j.jsx)(p.z,{variant:"outline",onClick:function(){return T(!1)},children:"Cancelar"}),(0,j.jsx)(p.z,{variant:"danger",onClick:V,children:"Eliminar"})]})]})})]})}}},function(e){e.O(0,[816,738,873,544,99,971,529,744],function(){return e(e.s=95266)}),_N_E=e.O()}]);