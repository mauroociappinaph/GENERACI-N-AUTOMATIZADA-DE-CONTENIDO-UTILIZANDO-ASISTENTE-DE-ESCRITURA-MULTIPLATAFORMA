(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{5332:function(e,r,t){Promise.resolve().then(t.bind(t,61133))},61133:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return S}});var n=t(50090),a=t(30837),s=t.n(a),i=t(2265),o=t(7232),c=t(36118),l=t(93394),u=t(84513),d=t(19245),p=t(57437);function m(e){var r=e.users,t=e.loading,n=e.pagination,a=e.onEdit,s=e.onToggleStatus,i=e.onDelete,o=e.onPageChange,c=function(e){var r;return(r={},(0,u.Z)(r,l.i4.ADMIN,"bg-red-100 text-red-800"),(0,u.Z)(r,l.i4.MANAGER,"bg-blue-100 text-blue-800"),(0,u.Z)(r,l.i4.USER,"bg-green-100 text-green-800"),(0,u.Z)(r,l.i4.VIEWER,"bg-gray-100 text-gray-800"),r)[e]||"bg-gray-100 text-gray-800"};return t&&!r.length?(0,p.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,p.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsx)("div",{className:"overflow-x-auto",children:(0,p.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,p.jsx)("thead",{className:"bg-gray-50",children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuario"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),(0,p.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Creado"}),(0,p.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),(0,p.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(function(e){return(0,p.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,p.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.firstName," ",e.lastName]})}),(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,p.jsx)("div",{className:"text-sm text-gray-900",children:e.email})}),(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,p.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(c(e.role)),children:e.role})}),(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,p.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Activo":"Inactivo"})}),(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}),(0,p.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,p.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,p.jsx)(d.z,{variant:"outline",size:"sm",onClick:function(){return a(e)},children:"Editar"}),(0,p.jsx)(d.z,{variant:"outline",size:"sm",onClick:function(){return s(e.id)},className:e.isActive?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800",children:e.isActive?"Desactivar":"Activar"}),(0,p.jsx)(d.z,{variant:"outline",size:"sm",onClick:function(){return i(e.id)},className:"text-red-600 hover:text-red-800",children:"Eliminar"})]})})]},e.id)})})]})}),0===r.length&&!t&&(0,p.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No se encontraron usuarios"}),n.totalPages>1&&(0,p.jsxs)("div",{className:"flex items-center justify-between",children:[(0,p.jsxs)("div",{className:"text-sm text-gray-700",children:["Mostrando ",(n.page-1)*n.limit+1," a"," ",Math.min(n.page*n.limit,n.total)," de"," ",n.total," usuarios"]}),(0,p.jsxs)("div",{className:"flex gap-2",children:[(0,p.jsx)(d.z,{variant:"outline",size:"sm",onClick:function(){return o(n.page-1)},disabled:n.page<=1,children:"Anterior"}),Array.from({length:n.totalPages},function(e,r){return r+1}).filter(function(e){var r=n.page;return 1===e||e===n.totalPages||e>=r-1&&e<=r+1}).map(function(e,r,t){return(0,p.jsxs)("div",{className:"flex items-center",children:[r>0&&t[r-1]!==e-1&&(0,p.jsx)("span",{className:"px-2 text-gray-500",children:"..."}),(0,p.jsx)(d.z,{variant:n.page===e?"default":"outline",size:"sm",onClick:function(){return o(e)},children:e})]},e)}),(0,p.jsx)(d.z,{variant:"outline",size:"sm",onClick:function(){return o(n.page+1)},disabled:n.page>=n.totalPages,children:"Siguiente"})]})]})]})}var f=t(55010);function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function x(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?h(Object(t),!0).forEach(function(r){(0,u.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function v(e){var r,t=e.roles,a=e.onSubmit,o=e.onClose,c=(0,i.useState)({email:"",password:"",firstName:"",lastName:"",role:l.i4.USER}),m=c[0],h=c[1],v=(0,i.useState)(!1),g=v[0],b=v[1],j=(0,i.useState)({}),y=j[0],N=j[1],w=function(){var e={};return m.email?/\S+@\S+\.\S+/.test(m.email)||(e.email="El email no es v\xe1lido"):e.email="El email es requerido",m.password?m.password.length<8&&(e.password="La contrase\xf1a debe tener al menos 8 caracteres"):e.password="La contrase\xf1a es requerida",m.firstName||(e.firstName="El nombre es requerido"),m.lastName||(e.lastName="El apellido es requerido"),N(e),0===Object.keys(e).length},k=(r=(0,n.Z)(s().mark(function e(r){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),w()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,b(!0),e.next=7,a(m);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Error creating user:",e.t0);case 12:return e.prev=12,b(!1),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[3,9,12,15]])})),function(e){return r.apply(this,arguments)}),E=function(e,r){h(function(t){return x(x({},t),{},(0,u.Z)({},e,r))}),y[e]&&N(function(r){return x(x({},r),{},(0,u.Z)({},e,""))})};return(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,p.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Crear Nuevo Usuario"}),(0,p.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),(0,p.jsx)(f.I,{id:"firstName",type:"text",value:m.firstName,onChange:function(e){return E("firstName",e.target.value)},className:y.firstName?"border-red-500":""}),y.firstName&&(0,p.jsx)("p",{className:"text-red-500 text-sm mt-1",children:y.firstName})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido"}),(0,p.jsx)(f.I,{id:"lastName",type:"text",value:m.lastName,onChange:function(e){return E("lastName",e.target.value)},className:y.lastName?"border-red-500":""}),y.lastName&&(0,p.jsx)("p",{className:"text-red-500 text-sm mt-1",children:y.lastName})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,p.jsx)(f.I,{id:"email",type:"email",value:m.email,onChange:function(e){return E("email",e.target.value)},className:y.email?"border-red-500":""}),y.email&&(0,p.jsx)("p",{className:"text-red-500 text-sm mt-1",children:y.email})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrase\xf1a"}),(0,p.jsx)(f.I,{id:"password",type:"password",value:m.password,onChange:function(e){return E("password",e.target.value)},className:y.password?"border-red-500":""}),y.password&&(0,p.jsx)("p",{className:"text-red-500 text-sm mt-1",children:y.password})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),(0,p.jsx)("select",{id:"role",value:m.role,onChange:function(e){return E("role",e.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:t.map(function(e){return(0,p.jsx)("option",{value:e,children:e},e)})})]}),(0,p.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,p.jsx)(d.z,{type:"button",variant:"outline",onClick:o,disabled:g,children:"Cancelar"}),(0,p.jsx)(d.z,{type:"submit",disabled:g,children:g?"Creando...":"Crear Usuario"})]})]})]})})}function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function b(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach(function(r){(0,u.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function j(e){var r,t=e.user,a=e.roles,o=e.onSubmit,c=e.onClose,l=(0,i.useState)({email:t.email,firstName:t.firstName,lastName:t.lastName,role:t.role,isActive:t.isActive}),m=l[0],h=l[1],x=(0,i.useState)(!1),v=x[0],g=x[1],j=(0,i.useState)({}),y=j[0],N=j[1];(0,i.useEffect)(function(){h({email:t.email,firstName:t.firstName,lastName:t.lastName,role:t.role,isActive:t.isActive})},[t]);var w=function(){var e={};return m.email?/\S+@\S+\.\S+/.test(m.email)||(e.email="El email no es v\xe1lido"):e.email="El email es requerido",m.firstName||(e.firstName="El nombre es requerido"),m.lastName||(e.lastName="El apellido es requerido"),N(e),0===Object.keys(e).length},k=(r=(0,n.Z)(s().mark(function e(r){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),w()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,g(!0),e.next=7,o(m);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Error updating user:",e.t0);case 12:return e.prev=12,g(!1),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[3,9,12,15]])})),function(e){return r.apply(this,arguments)}),E=function(e,r){h(function(t){return b(b({},t),{},(0,u.Z)({},e,r))}),y[e]&&N(function(r){return b(b({},r),{},(0,u.Z)({},e,""))})};return(0,p.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,p.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Editar Usuario"}),(0,p.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),(0,p.jsx)(f.I,{id:"firstName",type:"text",value:m.firstName,onChange:function(e){return E("firstName",e.target.value)},className:y.firstName?"border-red-500":""}),y.firstName&&(0,p.jsx)("p",{className:"text-red-500 text-sm mt-1",children:y.firstName})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Apellido"}),(0,p.jsx)(f.I,{id:"lastName",type:"text",value:m.lastName,onChange:function(e){return E("lastName",e.target.value)},className:y.lastName?"border-red-500":""}),y.lastName&&(0,p.jsx)("p",{className:"text-red-500 text-sm mt-1",children:y.lastName})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,p.jsx)(f.I,{id:"email",type:"email",value:m.email,onChange:function(e){return E("email",e.target.value)},className:y.email?"border-red-500":""}),y.email&&(0,p.jsx)("p",{className:"text-red-500 text-sm mt-1",children:y.email})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),(0,p.jsx)("select",{id:"role",value:m.role,onChange:function(e){return E("role",e.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:a.map(function(e){return(0,p.jsx)("option",{value:e,children:e},e)})})]}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("input",{id:"isActive",type:"checkbox",checked:m.isActive,onChange:function(e){return E("isActive",e.target.checked)},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,p.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-900",children:"Usuario activo"})]}),(0,p.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,p.jsx)(d.z,{type:"button",variant:"outline",onClick:c,disabled:v,children:"Cancelar"}),(0,p.jsx)(d.z,{type:"submit",disabled:v,children:v?"Guardando...":"Guardar Cambios"})]})]})]})})}function y(e){var r=e.searchTerm,t=e.roleFilter,n=e.statusFilter,a=e.roles,s=e.onSearchChange,i=e.onRoleFilterChange,o=e.onStatusFilterChange,c=e.onSearch,l=e.onCreateUser;return(0,p.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-end",children:[(0,p.jsx)("form",{onSubmit:c,className:"flex-1",children:(0,p.jsx)(f.I,{type:"text",placeholder:"Buscar usuarios por nombre o email...",value:r,onChange:function(e){return s(e.target.value)}})}),(0,p.jsxs)("div",{className:"flex gap-2",children:[(0,p.jsxs)("select",{value:t,onChange:function(e){return i(e.target.value)},className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,p.jsx)("option",{value:"ALL",children:"Todos los roles"}),a.map(function(e){return(0,p.jsx)("option",{value:e,children:e},e)})]}),(0,p.jsxs)("select",{value:n,onChange:function(e){return o(e.target.value)},className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,p.jsx)("option",{value:"ALL",children:"Todos los estados"}),(0,p.jsx)("option",{value:"ACTIVE",children:"Activos"}),(0,p.jsx)("option",{value:"INACTIVE",children:"Inactivos"})]}),(0,p.jsx)(d.z,{onClick:l,children:"Crear Usuario"})]})]})}var N=t(21594);function w(e){var r=e.open,t=e.onOpenChange,n=e.onConfirm;return(0,p.jsx)(N.aR,{open:r,onOpenChange:t,children:(0,p.jsxs)(N._T,{children:[(0,p.jsxs)(N.fY,{children:[(0,p.jsx)(N.f$,{children:"Confirmar eliminaci\xf3n"}),(0,p.jsx)(N.yT,{children:"\xbfEst\xe1 seguro de que desea eliminar este usuario? Esta acci\xf3n no se puede deshacer."})]}),(0,p.jsxs)(N.xo,{children:[(0,p.jsx)(N.le,{onClick:function(){return t(!1)},children:"Cancelar"}),(0,p.jsx)(N.OL,{onClick:n,variant:"destructive",children:"Eliminar"})]})]})})}var k=t(5813);function E(){var e,r,t,a,o,c=(0,i.useState)([]),l=c[0],u=c[1],d=(0,i.useState)(!1),p=d[0],m=d[1],f=(0,i.useState)(null),h=f[0],x=f[1],v=(0,i.useState)({page:1,limit:10,total:0,totalPages:0}),g=v[0],b=v[1],j=(0,i.useState)([]),y=j[0],N=j[1],w=(0,i.useCallback)(function(e){var r=new URLSearchParams;return e.page&&r.append("page",e.page.toString()),e.limit&&r.append("limit",e.limit.toString()),e.role&&r.append("role",e.role),void 0!==e.isActive&&r.append("isActive",e.isActive.toString()),e.search&&r.append("search",e.search),r.toString()},[]),E=(0,i.useCallback)(function(e){u(e.data.users),b({page:e.data.page,limit:e.data.limit||10,total:e.data.total,totalPages:e.data.totalPages})},[]),C=(0,i.useCallback)(function(e){var r;x((null===(r=e.response)||void 0===r||null===(r=r.data)||void 0===r||null===(r=r.error)||void 0===r?void 0:r.message)||"Error al obtener usuarios")},[]);return{users:l,loading:p,error:h,pagination:g,roles:y,fetchUsers:(0,i.useCallback)((0,n.Z)(s().mark(function e(){var r,t,n,a,i=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},e.prev=1,m(!0),x(null),n=w(r),e.next=7,k.hi.get("/users?".concat(n));case 7:if(!(null!=(a=e.sent)&&null!==(t=a.data)&&void 0!==t&&t.success)){e.next=12;break}E(a.data),e.next=13;break;case 12:throw Error("Error al obtener usuarios");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),C(e.t0);case 18:return e.prev=18,m(!1),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[1,15,18,21]])})),[w,E,C]),fetchRoles:(0,i.useCallback)((0,n.Z)(s().mark(function e(){var r,t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.hi.get("/users/roles");case 3:null!=(t=e.sent)&&null!==(r=t.data)&&void 0!==r&&r.success&&N(t.data.data.roles),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}},e,null,[[0,7]])})),[]),createUser:(0,i.useCallback)((e=(0,n.Z)(s().mark(function e(r){var t,n,a,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(null),e.next=4,k.hi.post("/users",r);case 4:if(null!=(n=e.sent)&&null!==(t=n.data)&&void 0!==t&&t.success){e.next=7;break}throw Error("Error al crear usuario");case 7:return e.abrupt("return",n.data.data.user);case 10:throw e.prev=10,e.t0=e.catch(0),x(i=(null===(a=e.t0.response)||void 0===a||null===(a=a.data)||void 0===a||null===(a=a.error)||void 0===a?void 0:a.message)||"Error al crear usuario"),Error(i);case 16:case"end":return e.stop()}},e,null,[[0,10]])})),function(r){return e.apply(this,arguments)}),[]),updateUser:(0,i.useCallback)((r=(0,n.Z)(s().mark(function e(r,t){var n,a,i,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(null),e.next=4,k.hi.put("/users/".concat(r),t);case 4:if(null!=(a=e.sent)&&null!==(n=a.data)&&void 0!==n&&n.success){e.next=7;break}throw Error("Error al actualizar usuario");case 7:return e.abrupt("return",a.data.data.user);case 10:throw e.prev=10,e.t0=e.catch(0),x(o=(null===(i=e.t0.response)||void 0===i||null===(i=i.data)||void 0===i||null===(i=i.error)||void 0===i?void 0:i.message)||"Error al actualizar usuario"),Error(o);case 16:case"end":return e.stop()}},e,null,[[0,10]])})),function(e,t){return r.apply(this,arguments)}),[]),toggleUserStatus:(0,i.useCallback)((t=(0,n.Z)(s().mark(function e(r){var t,n,a,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(null),e.next=4,k.hi.patch("/users/".concat(r,"/toggle-status"));case 4:if(null!=(n=e.sent)&&null!==(t=n.data)&&void 0!==t&&t.success){e.next=7;break}throw Error("Error al cambiar estado del usuario");case 7:return e.abrupt("return",n.data.data.user);case 10:throw e.prev=10,e.t0=e.catch(0),x(i=(null===(a=e.t0.response)||void 0===a||null===(a=a.data)||void 0===a||null===(a=a.error)||void 0===a?void 0:a.message)||"Error al cambiar estado del usuario"),Error(i);case 16:case"end":return e.stop()}},e,null,[[0,10]])})),function(e){return t.apply(this,arguments)}),[]),deleteUser:(0,i.useCallback)((a=(0,n.Z)(s().mark(function e(r){var t,n,a,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(null),e.next=4,k.hi.delete("/users/".concat(r));case 4:if(null!=(n=e.sent)&&null!==(t=n.data)&&void 0!==t&&t.success){e.next=7;break}throw Error("Error al eliminar usuario");case 7:return e.abrupt("return",!0);case 10:throw e.prev=10,e.t0=e.catch(0),x(i=(null===(a=e.t0.response)||void 0===a||null===(a=a.data)||void 0===a||null===(a=a.error)||void 0===a?void 0:a.message)||"Error al eliminar usuario"),Error(i);case 16:case"end":return e.stop()}},e,null,[[0,10]])})),function(e){return a.apply(this,arguments)}),[]),changePassword:(0,i.useCallback)((o=(0,n.Z)(s().mark(function e(r,t,n){var a,i,o,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(null),e.next=4,k.hi.put("/users/".concat(r,"/password"),{currentPassword:t,newPassword:n});case 4:if(null!=(i=e.sent)&&null!==(a=i.data)&&void 0!==a&&a.success){e.next=7;break}throw Error("Error al cambiar contrase\xf1a");case 7:return e.abrupt("return",!0);case 10:throw e.prev=10,e.t0=e.catch(0),x(c=(null===(o=e.t0.response)||void 0===o||null===(o=o.data)||void 0===o||null===(o=o.error)||void 0===o?void 0:o.message)||"Error al cambiar contrase\xf1a"),Error(c);case 16:case"end":return e.stop()}},e,null,[[0,10]])})),function(e,r,t){return o.apply(this,arguments)}),[])}}var C=t(12693),O=t(69161);function S(){var e,r,t,a,u,d,f,h,x,g,b,N,k,S,A,P,Z,U,D,z,F,L,T,I,R,q,G,M,_,V,J,Y,B,$,H,W,K,Q=(0,i.useState)(!1),X=Q[0],ee=Q[1],er=(0,i.useState)(null),et=er[0],en=er[1],ea=E(),es=ea.users,ei=ea.loading,eo=ea.error,ec=ea.pagination,el=ea.roles,eu=ea.fetchRoles,ed=(r=(e=(0,i.useState)(""))[0],t=e[1],u=(a=(0,i.useState)("ALL"))[0],d=a[1],h=(f=(0,i.useState)("ALL"))[0],x=f[1],b=(g=E()).fetchUsers,N=g.pagination,k=(0,i.useCallback)(function(){return{page:1,limit:10,role:"ALL"===u?void 0:u,isActive:"ALL"===h?void 0:"ACTIVE"===h,search:r||void 0}},[u,h,r]),S=(0,i.useCallback)(function(){return{page:N.page,limit:N.limit,role:"ALL"===u?void 0:u,isActive:"ALL"===h?void 0:"ACTIVE"===h,search:r||void 0}},[u,h,r,N]),(0,i.useEffect)(function(){b(k())},[u,h,r,b,k]),{searchTerm:r,setSearchTerm:t,roleFilter:u,setRoleFilter:d,statusFilter:h,setStatusFilter:x,buildFetchParams:k,buildCurrentPageFetchParams:S,handleSearch:function(e){e.preventDefault(),b(k())},handlePageChange:function(e){b({page:e,limit:N.limit,role:"ALL"===u?void 0:u,isActive:"ALL"===h?void 0:"ACTIVE"===h,search:r||void 0})}}),ep=ed.searchTerm,em=ed.setSearchTerm,ef=ed.roleFilter,eh=ed.setRoleFilter,ex=ed.statusFilter,ev=ed.setStatusFilter,eg=ed.buildCurrentPageFetchParams,eb=ed.handleSearch,ej=ed.handlePageChange,ey=(P=(A=(0,i.useState)(!1))[0],Z=A[1],D=(U=(0,i.useState)(null))[0],z=U[1],L=(F=E()).createUser,T=F.updateUser,I=F.toggleUserStatus,R=F.deleteUser,q=F.fetchUsers,G=(0,n.Z)(s().mark(function e(r,t,n){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L(r);case 3:return(0,C.A)({title:"Usuario creado",description:"El usuario ha sido creado exitosamente"}),e.next=6,q(t);case 6:null==n||n(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,C.A)({title:"Error al crear usuario",description:e.t0 instanceof Error?e.t0.message:"Error desconocido",variant:"destructive"});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),M=function(e,r,t){return G.apply(this,arguments)},_=(0,n.Z)(s().mark(function e(r,t,n,a){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T(r,t);case 3:return(0,C.A)({title:"Usuario actualizado",description:"El usuario ha sido actualizado exitosamente"}),e.next=6,q(n);case 6:null==a||a(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,C.A)({title:"Error al actualizar usuario",description:e.t0 instanceof Error?e.t0.message:"Error desconocido",variant:"destructive"});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),V=function(e,r,t,n){return _.apply(this,arguments)},J=(0,n.Z)(s().mark(function e(r,t){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I(r);case 3:return(0,C.A)({title:"Estado actualizado",description:"El estado del usuario ha sido actualizado exitosamente"}),e.next=6,q(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),(0,C.A)({title:"Error al cambiar estado del usuario",description:e.t0 instanceof Error?e.t0.message:"Error desconocido",variant:"destructive"});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),Y=function(e,r){return J.apply(this,arguments)},B=(0,n.Z)(s().mark(function e(r){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,R(D);case 5:return(0,C.A)({title:"Usuario eliminado",description:"El usuario ha sido eliminado exitosamente"}),e.next=8,q(r);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),(0,C.A)({title:"Error al eliminar usuario",description:e.t0 instanceof Error?e.t0.message:"Error desconocido",variant:"destructive"});case 13:return e.prev=13,Z(!1),z(null),e.finish(13);case 17:case"end":return e.stop()}},e,null,[[2,10,13,17]])})),{deleteConfirmOpen:P,setDeleteConfirmOpen:Z,userToDelete:D,handleCreateUser:M,handleEditUser:V,handleToggleStatus:Y,handleDeleteUser:function(e){z(e),Z(!0)},confirmDeleteUser:function(e){return B.apply(this,arguments)}}),eN=ey.deleteConfirmOpen,ew=ey.setDeleteConfirmOpen,ek=ey.handleCreateUser,eE=ey.handleEditUser,eC=ey.handleToggleStatus,eO=ey.handleDeleteUser,eS=ey.confirmDeleteUser;(0,i.useEffect)(function(){eu()},[eu]);var eA=($=(0,n.Z)(s().mark(function e(r){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ek(r,eg(),function(){ee(!1)});case 2:case"end":return e.stop()}},e)})),function(e){return $.apply(this,arguments)}),eP=(H=(0,n.Z)(s().mark(function e(r){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(et){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,eE(et.id,r,eg(),function(){en(null)});case 4:case"end":return e.stop()}},e)})),function(e){return H.apply(this,arguments)}),eZ=(W=(0,n.Z)(s().mark(function e(r){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eC(r,eg());case 2:case"end":return e.stop()}},e)})),function(e){return W.apply(this,arguments)}),eU=(K=(0,n.Z)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eS(eg());case 2:case"end":return e.stop()}},e)})),function(){return K.apply(this,arguments)});return ei&&!es.length?(0,p.jsx)(o.Z,{title:"Gesti\xf3n de Usuarios",allowedRoles:[l.i4.ADMIN,l.i4.MANAGER],children:(0,p.jsx)(O.g,{})}):(0,p.jsx)(o.Z,{title:"Gesti\xf3n de Usuarios",allowedRoles:[l.i4.ADMIN,l.i4.MANAGER],children:(0,p.jsxs)("div",{className:"space-y-6",children:[(0,p.jsxs)(c.Zb,{children:[(0,p.jsx)(c.Ol,{children:(0,p.jsx)(c.ll,{children:"Administraci\xf3n de Usuarios"})}),(0,p.jsx)(c.aY,{children:(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsx)(y,{searchTerm:ep,roleFilter:ef,statusFilter:ex,roles:el,onSearchChange:em,onRoleFilterChange:eh,onStatusFilterChange:ev,onSearch:eb,onCreateUser:function(){return ee(!0)}}),eo&&(0,p.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:eo}),(0,p.jsx)(m,{users:es,loading:ei,pagination:ec,onEdit:en,onToggleStatus:eZ,onDelete:eO,onPageChange:ej})]})})]}),X&&(0,p.jsx)(v,{roles:el,onSubmit:eA,onClose:function(){return ee(!1)}}),et&&(0,p.jsx)(j,{user:et,roles:el,onSubmit:eP,onClose:function(){return en(null)}}),(0,p.jsx)(w,{open:eN,onOpenChange:ew,onConfirm:eU})]})})}},21594:function(e,r,t){"use strict";t.d(r,{OL:function(){return d},_T:function(){return i},aR:function(){return s},f$:function(){return c},fY:function(){return o},le:function(){return p},xo:function(){return u},yT:function(){return l}});var n=t(19245),a=t(57437);function s(e){var r=e.open,t=e.onOpenChange,n=e.children;return r?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50",onClick:function(){return t(!1)}}),(0,a.jsx)("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:n})]}):null}function i(e){var r=e.children;return(0,a.jsx)("div",{className:"p-6",children:r})}function o(e){var r=e.children;return(0,a.jsx)("div",{className:"mb-4",children:r})}function c(e){var r=e.children;return(0,a.jsx)("h2",{className:"text-lg font-semibold",children:r})}function l(e){var r=e.children;return(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:r})}function u(e){var r=e.children;return(0,a.jsx)("div",{className:"flex justify-end space-x-2 mt-6",children:r})}function d(e){var r=e.onClick,t=e.children,s=e.variant;return(0,a.jsx)(n.z,{onClick:r,variant:"destructive"===(void 0===s?"default":s)?"danger":"primary",children:t})}function p(e){var r=e.onClick,t=e.children;return(0,a.jsx)(n.z,{onClick:r,variant:"outline",children:t})}},55010:function(e,r,t){"use strict";t.d(r,{I:function(){return u}});var n=t(84513),a=t(83366),s=t(39436),i=t(2265),o=t(57437),c=["className","error"];function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}var u=(0,i.forwardRef)(function(e,r){var t=e.className,i=e.error,u=(0,a.Z)(e,c);return(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsx)("input",function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}({className:(0,s.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50",i&&"border-red-500 focus:ring-red-500",t),ref:r},u)),i&&(0,o.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i})]})});u.displayName="Input"},12693:function(e,r,t){"use strict";t.d(r,{A:function(){return s},p:function(){return a}});var n=t(29738),a=function(){return{toast:function(e){"destructive"===e.variant?n.ZP.error(e.description||e.title||"Error"):n.ZP.success(e.description||e.title||"Success")}}},s=function(e){"destructive"===e.variant?n.ZP.error(e.description||e.title||"Error"):n.ZP.success(e.description||e.title||"Success")}},5813:function(e,r,t){"use strict";t.d(r,{hi:function(){return p},x1:function(){return d}});var n=t(84513),a=t(50090),s=t(35685),i=t(10026),o=t(30837),c=t.n(o);function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function u(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach(function(r){(0,n.Z)(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var d=new(function(){var e,r,t,n,o,l;function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http://localhost:3001";(0,s.Z)(this,d),this.baseURL=e}return(0,i.Z)(d,[{key:"request",value:(e=(0,a.Z)(c().mark(function e(r){var t,n,a,s,i,o,l,d=arguments;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>1&&void 0!==d[1]?d[1]:{},n="".concat(this.baseURL).concat(r),a=u({headers:u({"Content-Type":"application/json"},t.headers)},t),(s=localStorage.getItem("accessToken"))&&(a.headers=u(u({},a.headers),{},{Authorization:"Bearer ".concat(s)})),e.prev=5,e.next=8,fetch(n,a);case 8:return i=e.sent,e.next=11,i.json();case 11:if(o=e.sent,i.ok){e.next=14;break}throw Error((null===(l=o.error)||void 0===l?void 0:l.message)||"API request failed");case 14:return e.abrupt("return",o);case 17:throw e.prev=17,e.t0=e.catch(5),console.error("API request error:",e.t0),e.t0;case 21:case"end":return e.stop()}},e,this,[[5,17]])})),function(r){return e.apply(this,arguments)})},{key:"get",value:(r=(0,a.Z)(c().mark(function e(r){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(r,{method:"GET"}));case 1:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"post",value:(t=(0,a.Z)(c().mark(function e(r,t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(r,{method:"POST",body:t?JSON.stringify(t):void 0}));case 1:case"end":return e.stop()}},e,this)})),function(e,r){return t.apply(this,arguments)})},{key:"put",value:(n=(0,a.Z)(c().mark(function e(r,t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(r,{method:"PUT",body:t?JSON.stringify(t):void 0}));case 1:case"end":return e.stop()}},e,this)})),function(e,r){return n.apply(this,arguments)})},{key:"patch",value:(o=(0,a.Z)(c().mark(function e(r,t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(r,{method:"PATCH",body:t?JSON.stringify(t):void 0}));case 1:case"end":return e.stop()}},e,this)})),function(e,r){return o.apply(this,arguments)})},{key:"delete",value:(l=(0,a.Z)(c().mark(function e(r){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request(r,{method:"DELETE"}));case 1:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})}]),d}()),p=d}},function(e){e.O(0,[816,738,873,880,92,232,971,529,744],function(){return e(e.s=5332)}),_N_E=e.O()}]);